# start sql code
# output table name: sql_table

select
    `RefId` as RefId_1,
    `PurchDate` as training_PurchDate_original_0,
    `RefId` as training_RefId_original_1,
    `IsBadBuy` as training_IsBadBuy_original_2,
    `AUCGUART` as training_AUCGUART_original_3,
    `Auction` as training_Auction_original_4,
    `BYRNO` as training_BYRNO_original_5,
    `Color` as training_Color_original_6,
    `IsOnlineSale` as training_IsOnlineSale_original_7,
    `MMRAcquisitionAuctionAveragePrice` as training_MMRAcquisitionAuctionAveragePrice_original_8,
    `MMRAcquisitionAuctionCleanPrice` as training_MMRAcquisitionAuctionCleanPrice_original_9,
    `MMRAcquisitionRetailAveragePrice` as training_MMRAcquisitionRetailAveragePrice_original_10,
    `MMRAcquisitonRetailCleanPrice` as training_MMRAcquisitonRetailCleanPrice_original_11,
    `MMRCurrentAuctionAveragePrice` as training_MMRCurrentAuctionAveragePrice_original_12,
    `MMRCurrentAuctionCleanPrice` as training_MMRCurrentAuctionCleanPrice_original_13,
    `MMRCurrentRetailAveragePrice` as training_MMRCurrentRetailAveragePrice_original_14,
    `MMRCurrentRetailCleanPrice` as training_MMRCurrentRetailCleanPrice_original_15,
    `Make` as training_Make_original_16,
    `Model` as training_Model_original_17,
    `Nationality` as training_Nationality_original_18,
    `PRIMEUNIT` as training_PRIMEUNIT_original_19,
    `Size` as training_Size_original_20,
    `SubModel` as training_SubModel_original_21,
    `TopThreeAmericanName` as training_TopThreeAmericanName_original_22,
    `Transmission` as training_Transmission_original_23,
    `Trim` as training_Trim_original_24,
    `VNST` as training_VNST_original_25,
    `VNZIP1` as training_VNZIP1_original_26,
    `VehBCost` as training_VehBCost_original_27,
    `VehOdo` as training_VehOdo_original_28,
    `VehYear` as training_VehYear_original_29,
    `VehicleAge` as training_VehicleAge_original_30,
    `WarrantyCost` as training_WarrantyCost_original_31,
    `WheelType` as training_WheelType_original_32,
    `WheelTypeID` as training_WheelTypeID_original_33,
    `WheelTypeID` as training_WheelTypeID_combine_34,
    `Auction` as training_Auction_combine_34,
    `WheelType` as training_WheelType_combine_35,
    `Auction` as training_Auction_combine_35,
    `WheelTypeID` as training_WheelTypeID_combine_36,
    `PRIMEUNIT` as training_PRIMEUNIT_combine_36,
    `WheelType` as training_WheelType_combine_37,
    `PRIMEUNIT` as training_PRIMEUNIT_combine_37,
    `WheelTypeID` as training_WheelTypeID_combine_38,
    `AUCGUART` as training_AUCGUART_combine_38,
    `WheelType` as training_WheelType_combine_39,
    `AUCGUART` as training_AUCGUART_combine_39,
    `VehicleAge` as training_VehicleAge_combine_40,
    `AUCGUART` as training_AUCGUART_combine_40,
    `VehicleAge` as training_VehicleAge_combine_41,
    `PRIMEUNIT` as training_PRIMEUNIT_combine_41,
    `PRIMEUNIT` as training_PRIMEUNIT_combine_42,
    `Nationality` as training_Nationality_combine_42,
    `Model` as training_Model_combine_43,
    `VNST` as training_VNST_combine_43,
    `Model` as training_Model_combine_44,
    `Auction` as training_Auction_combine_44,
    `Model` as training_Model_combine_45,
    `Color` as training_Color_combine_45,
    `WarrantyCost` as training_WarrantyCost_combine_46,
    `Model` as training_Model_combine_46,
    `VNZIP1` as training_VNZIP1_combine_47,
    `BYRNO` as training_BYRNO_combine_47,
    `WarrantyCost` as training_WarrantyCost_combine_48,
    `SubModel` as training_SubModel_combine_48,
    `VNZIP1` as training_VNZIP1_combine_49,
    `AUCGUART` as training_AUCGUART_combine_49,
    `WarrantyCost` as training_WarrantyCost_combine_50,
    `Make` as training_Make_combine_50,
    max(`VehBCost`) over training_MMRCurrentAuctionCleanPrice_PurchDate_0s_7d_200 as training_VehBCost_window_max_51
from
    `training`
    window training_MMRCurrentAuctionCleanPrice_PurchDate_0s_7d_200 as (partition by `MMRCurrentAuctionCleanPrice` order by `PurchDate` rows_range between 7d open preceding and 0s preceding MAXSIZE 200);