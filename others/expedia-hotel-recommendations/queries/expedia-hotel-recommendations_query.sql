# start sql code
# output table name: sql_table
select * from 
(
select
    `user_id` as user_id_1,
    `date_time` as train_date_time_original_0,
    `user_id` as train_user_id_original_1,
    `hotel_cluster` as train_hotel_cluster_original_2,
    `channel` as train_channel_original_152,
    `cnt` as train_cnt_original_153,
    `hotel_continent` as train_hotel_continent_original_154,
    `hotel_country` as train_hotel_country_original_155,
    `hotel_market` as train_hotel_market_original_156,
    `is_booking` as train_is_booking_original_157,
    `is_mobile` as train_is_mobile_original_158,
    `is_package` as train_is_package_original_159,
    `orig_destination_distance` as train_orig_destination_distance_original_160,
    `posa_continent` as train_posa_continent_original_161,
    `site_name` as train_site_name_original_162,
    `srch_adults_cnt` as train_srch_adults_cnt_original_163,
    `srch_children_cnt` as train_srch_children_cnt_original_164,
    `srch_ci` as train_srch_ci_original_165,
    `srch_co` as train_srch_co_original_166,
    `srch_destination_id` as train_srch_destination_id_original_167,
    `srch_destination_type_id` as train_srch_destination_type_id_original_168,
    `srch_rm_cnt` as train_srch_rm_cnt_original_169,
    `user_location_city` as train_user_location_city_original_170,
    `user_location_country` as train_user_location_country_original_171,
    `user_location_region` as train_user_location_region_original_172,
    `srch_destination_type_id` as train_srch_destination_type_id_combine_173,
    `is_booking` as train_is_booking_combine_173,
    `srch_destination_type_id` as train_srch_destination_type_id_combine_174,
    `is_mobile` as train_is_mobile_combine_174,
    `srch_destination_type_id` as train_srch_destination_type_id_combine_175,
    `posa_continent` as train_posa_continent_combine_175,
    `srch_destination_type_id` as train_srch_destination_type_id_combine_176,
    `srch_rm_cnt` as train_srch_rm_cnt_combine_176,
    distinct_count(`srch_children_cnt`) over train_srch_destination_type_id_date_time_0s_1h_200 as train_srch_children_cnt_window_unique_count_177,
    case when !isnull(at(`srch_destination_type_id`, 0)) over train_cnt_date_time_0s_14d_200 then count_where(`srch_destination_type_id`, `srch_destination_type_id` = at(`srch_destination_type_id`, 0)) over train_cnt_date_time_0s_14d_200 else null end as train_srch_destination_type_id_window_count_178,
    case when !isnull(at(`srch_destination_type_id`, 0)) over train_cnt_date_time_0s_7d_200 then count_where(`srch_destination_type_id`, `srch_destination_type_id` = at(`srch_destination_type_id`, 0)) over train_cnt_date_time_0s_7d_200 else null end as train_srch_destination_type_id_window_count_179,
    distinct_count(`channel`) over train_srch_destination_type_id_date_time_0s_1h_200 as train_channel_window_unique_count_180,
    distinct_count(`srch_destination_id`) over train_srch_destination_type_id_date_time_0_10_ as train_srch_destination_id_window_unique_count_181,
    case when !isnull(at(`hotel_continent`, 0)) over train_srch_ci_date_time_0s_1h_200 then count_where(`hotel_continent`, `hotel_continent` = at(`hotel_continent`, 0)) over train_srch_ci_date_time_0s_1h_200 else null end as train_hotel_continent_window_count_182,
    case when !isnull(at(`hotel_country`, 0)) over train_srch_co_date_time_0s_1h_200 then count_where(`hotel_country`, `hotel_country` = at(`hotel_country`, 0)) over train_srch_co_date_time_0s_1h_200 else null end as train_hotel_country_window_count_183,
    case when !isnull(at(`hotel_country`, 0)) over train_srch_co_date_time_0s_5h_200 then count_where(`hotel_country`, `hotel_country` = at(`hotel_country`, 0)) over train_srch_co_date_time_0s_5h_200 else null end as train_hotel_country_window_count_184,
    case when !isnull(at(`hotel_market`, 0)) over train_srch_destination_id_date_time_0s_1h_100 then count_where(`hotel_market`, `hotel_market` = at(`hotel_market`, 0)) over train_srch_destination_id_date_time_0s_1h_100 else null end as train_hotel_market_window_count_185,
    case when !isnull(at(`hotel_continent`, 0)) over train_srch_ci_date_time_0s_10h_200 then count_where(`hotel_continent`, `hotel_continent` = at(`hotel_continent`, 0)) over train_srch_ci_date_time_0s_10h_200 else null end as train_hotel_continent_window_count_186,
    distinct_count(`site_name`) over train_srch_destination_type_id_date_time_0s_1h_100 as train_site_name_window_unique_count_187,
    case when !isnull(at(`srch_destination_type_id`, 0)) over train_hotel_country_date_time_0s_5h_100 then count_where(`srch_destination_type_id`, `srch_destination_type_id` = at(`srch_destination_type_id`, 0)) over train_hotel_country_date_time_0s_5h_100 else null end as train_srch_destination_type_id_window_count_188,
    distinct_count(`is_mobile`) over train_srch_destination_type_id_date_time_0s_1h_100 as train_is_mobile_window_unique_count_189,
    distinct_count(`site_name`) over train_hotel_market_date_time_0_10_ as train_site_name_window_unique_count_190
from
    `train`
    window train_srch_destination_type_id_date_time_0s_1h_200 as (partition by `srch_destination_type_id` order by `date_time` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_cnt_date_time_0s_14d_200 as (partition by `cnt` order by `date_time` rows_range between 14d open preceding and 0s preceding MAXSIZE 200),
    train_cnt_date_time_0s_7d_200 as (partition by `cnt` order by `date_time` rows_range between 7d open preceding and 0s preceding MAXSIZE 200),
    train_srch_destination_type_id_date_time_0_10_ as (partition by `srch_destination_type_id` order by `date_time` rows between 10 open preceding and 0 preceding),
    train_srch_ci_date_time_0s_1h_200 as (partition by `srch_ci` order by `date_time` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_srch_co_date_time_0s_1h_200 as (partition by `srch_co` order by `date_time` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_srch_co_date_time_0s_5h_200 as (partition by `srch_co` order by `date_time` rows_range between 5h open preceding and 0s preceding MAXSIZE 200),
    train_srch_destination_id_date_time_0s_1h_100 as (partition by `srch_destination_id` order by `date_time` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    train_srch_ci_date_time_0s_10h_200 as (partition by `srch_ci` order by `date_time` rows_range between 10h open preceding and 0s preceding MAXSIZE 200),
    train_srch_destination_type_id_date_time_0s_1h_100 as (partition by `srch_destination_type_id` order by `date_time` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    train_hotel_country_date_time_0s_5h_100 as (partition by `hotel_country` order by `date_time` rows_range between 5h open preceding and 0s preceding MAXSIZE 100),
    train_hotel_market_date_time_0_10_ as (partition by `hotel_market` order by `date_time` rows between 10 open preceding and 0 preceding))
as out0
last join
(
select
    `train`.`user_id` as user_id_4,
    `destinations_srch_destination_id`.`d1` as destinations_d1_multi_direct_3,
    `destinations_srch_destination_id`.`d10` as destinations_d10_multi_direct_4,
    `destinations_srch_destination_id`.`d100` as destinations_d100_multi_direct_5,
    `destinations_srch_destination_id`.`d101` as destinations_d101_multi_direct_6,
    `destinations_srch_destination_id`.`d102` as destinations_d102_multi_direct_7,
    `destinations_srch_destination_id`.`d103` as destinations_d103_multi_direct_8,
    `destinations_srch_destination_id`.`d104` as destinations_d104_multi_direct_9,
    `destinations_srch_destination_id`.`d105` as destinations_d105_multi_direct_10,
    `destinations_srch_destination_id`.`d106` as destinations_d106_multi_direct_11,
    `destinations_srch_destination_id`.`d107` as destinations_d107_multi_direct_12,
    `destinations_srch_destination_id`.`d108` as destinations_d108_multi_direct_13,
    `destinations_srch_destination_id`.`d109` as destinations_d109_multi_direct_14,
    `destinations_srch_destination_id`.`d11` as destinations_d11_multi_direct_15,
    `destinations_srch_destination_id`.`d110` as destinations_d110_multi_direct_16,
    `destinations_srch_destination_id`.`d111` as destinations_d111_multi_direct_17,
    `destinations_srch_destination_id`.`d112` as destinations_d112_multi_direct_18,
    `destinations_srch_destination_id`.`d113` as destinations_d113_multi_direct_19,
    `destinations_srch_destination_id`.`d114` as destinations_d114_multi_direct_20,
    `destinations_srch_destination_id`.`d115` as destinations_d115_multi_direct_21,
    `destinations_srch_destination_id`.`d116` as destinations_d116_multi_direct_22,
    `destinations_srch_destination_id`.`d117` as destinations_d117_multi_direct_23,
    `destinations_srch_destination_id`.`d118` as destinations_d118_multi_direct_24,
    `destinations_srch_destination_id`.`d119` as destinations_d119_multi_direct_25,
    `destinations_srch_destination_id`.`d12` as destinations_d12_multi_direct_26,
    `destinations_srch_destination_id`.`d120` as destinations_d120_multi_direct_27,
    `destinations_srch_destination_id`.`d121` as destinations_d121_multi_direct_28,
    `destinations_srch_destination_id`.`d122` as destinations_d122_multi_direct_29,
    `destinations_srch_destination_id`.`d123` as destinations_d123_multi_direct_30,
    `destinations_srch_destination_id`.`d124` as destinations_d124_multi_direct_31,
    `destinations_srch_destination_id`.`d125` as destinations_d125_multi_direct_32,
    `destinations_srch_destination_id`.`d126` as destinations_d126_multi_direct_33,
    `destinations_srch_destination_id`.`d127` as destinations_d127_multi_direct_34,
    `destinations_srch_destination_id`.`d128` as destinations_d128_multi_direct_35,
    `destinations_srch_destination_id`.`d129` as destinations_d129_multi_direct_36,
    `destinations_srch_destination_id`.`d13` as destinations_d13_multi_direct_37,
    `destinations_srch_destination_id`.`d130` as destinations_d130_multi_direct_38,
    `destinations_srch_destination_id`.`d131` as destinations_d131_multi_direct_39,
    `destinations_srch_destination_id`.`d132` as destinations_d132_multi_direct_40,
    `destinations_srch_destination_id`.`d133` as destinations_d133_multi_direct_41,
    `destinations_srch_destination_id`.`d134` as destinations_d134_multi_direct_42,
    `destinations_srch_destination_id`.`d135` as destinations_d135_multi_direct_43,
    `destinations_srch_destination_id`.`d136` as destinations_d136_multi_direct_44,
    `destinations_srch_destination_id`.`d137` as destinations_d137_multi_direct_45,
    `destinations_srch_destination_id`.`d138` as destinations_d138_multi_direct_46,
    `destinations_srch_destination_id`.`d139` as destinations_d139_multi_direct_47,
    `destinations_srch_destination_id`.`d14` as destinations_d14_multi_direct_48,
    `destinations_srch_destination_id`.`d140` as destinations_d140_multi_direct_49,
    `destinations_srch_destination_id`.`d141` as destinations_d141_multi_direct_50,
    `destinations_srch_destination_id`.`d142` as destinations_d142_multi_direct_51,
    `destinations_srch_destination_id`.`d143` as destinations_d143_multi_direct_52,
    `destinations_srch_destination_id`.`d144` as destinations_d144_multi_direct_53,
    `destinations_srch_destination_id`.`d145` as destinations_d145_multi_direct_54,
    `destinations_srch_destination_id`.`d146` as destinations_d146_multi_direct_55,
    `destinations_srch_destination_id`.`d147` as destinations_d147_multi_direct_56,
    `destinations_srch_destination_id`.`d148` as destinations_d148_multi_direct_57,
    `destinations_srch_destination_id`.`d149` as destinations_d149_multi_direct_58,
    `destinations_srch_destination_id`.`d15` as destinations_d15_multi_direct_59,
    `destinations_srch_destination_id`.`d16` as destinations_d16_multi_direct_60,
    `destinations_srch_destination_id`.`d17` as destinations_d17_multi_direct_61,
    `destinations_srch_destination_id`.`d18` as destinations_d18_multi_direct_62,
    `destinations_srch_destination_id`.`d19` as destinations_d19_multi_direct_63,
    `destinations_srch_destination_id`.`d2` as destinations_d2_multi_direct_64,
    `destinations_srch_destination_id`.`d20` as destinations_d20_multi_direct_65,
    `destinations_srch_destination_id`.`d21` as destinations_d21_multi_direct_66,
    `destinations_srch_destination_id`.`d22` as destinations_d22_multi_direct_67,
    `destinations_srch_destination_id`.`d23` as destinations_d23_multi_direct_68,
    `destinations_srch_destination_id`.`d24` as destinations_d24_multi_direct_69,
    `destinations_srch_destination_id`.`d25` as destinations_d25_multi_direct_70,
    `destinations_srch_destination_id`.`d26` as destinations_d26_multi_direct_71,
    `destinations_srch_destination_id`.`d27` as destinations_d27_multi_direct_72,
    `destinations_srch_destination_id`.`d28` as destinations_d28_multi_direct_73,
    `destinations_srch_destination_id`.`d29` as destinations_d29_multi_direct_74,
    `destinations_srch_destination_id`.`d3` as destinations_d3_multi_direct_75,
    `destinations_srch_destination_id`.`d30` as destinations_d30_multi_direct_76,
    `destinations_srch_destination_id`.`d31` as destinations_d31_multi_direct_77,
    `destinations_srch_destination_id`.`d32` as destinations_d32_multi_direct_78,
    `destinations_srch_destination_id`.`d33` as destinations_d33_multi_direct_79,
    `destinations_srch_destination_id`.`d34` as destinations_d34_multi_direct_80,
    `destinations_srch_destination_id`.`d35` as destinations_d35_multi_direct_81,
    `destinations_srch_destination_id`.`d36` as destinations_d36_multi_direct_82,
    `destinations_srch_destination_id`.`d37` as destinations_d37_multi_direct_83,
    `destinations_srch_destination_id`.`d38` as destinations_d38_multi_direct_84,
    `destinations_srch_destination_id`.`d39` as destinations_d39_multi_direct_85,
    `destinations_srch_destination_id`.`d4` as destinations_d4_multi_direct_86,
    `destinations_srch_destination_id`.`d40` as destinations_d40_multi_direct_87,
    `destinations_srch_destination_id`.`d41` as destinations_d41_multi_direct_88,
    `destinations_srch_destination_id`.`d42` as destinations_d42_multi_direct_89,
    `destinations_srch_destination_id`.`d43` as destinations_d43_multi_direct_90,
    `destinations_srch_destination_id`.`d44` as destinations_d44_multi_direct_91,
    `destinations_srch_destination_id`.`d45` as destinations_d45_multi_direct_92,
    `destinations_srch_destination_id`.`d46` as destinations_d46_multi_direct_93,
    `destinations_srch_destination_id`.`d47` as destinations_d47_multi_direct_94,
    `destinations_srch_destination_id`.`d48` as destinations_d48_multi_direct_95,
    `destinations_srch_destination_id`.`d49` as destinations_d49_multi_direct_96,
    `destinations_srch_destination_id`.`d5` as destinations_d5_multi_direct_97,
    `destinations_srch_destination_id`.`d50` as destinations_d50_multi_direct_98,
    `destinations_srch_destination_id`.`d51` as destinations_d51_multi_direct_99,
    `destinations_srch_destination_id`.`d52` as destinations_d52_multi_direct_100,
    `destinations_srch_destination_id`.`d53` as destinations_d53_multi_direct_101,
    `destinations_srch_destination_id`.`d54` as destinations_d54_multi_direct_102,
    `destinations_srch_destination_id`.`d55` as destinations_d55_multi_direct_103,
    `destinations_srch_destination_id`.`d56` as destinations_d56_multi_direct_104,
    `destinations_srch_destination_id`.`d57` as destinations_d57_multi_direct_105,
    `destinations_srch_destination_id`.`d58` as destinations_d58_multi_direct_106,
    `destinations_srch_destination_id`.`d59` as destinations_d59_multi_direct_107,
    `destinations_srch_destination_id`.`d6` as destinations_d6_multi_direct_108,
    `destinations_srch_destination_id`.`d60` as destinations_d60_multi_direct_109,
    `destinations_srch_destination_id`.`d61` as destinations_d61_multi_direct_110,
    `destinations_srch_destination_id`.`d62` as destinations_d62_multi_direct_111,
    `destinations_srch_destination_id`.`d63` as destinations_d63_multi_direct_112,
    `destinations_srch_destination_id`.`d64` as destinations_d64_multi_direct_113,
    `destinations_srch_destination_id`.`d65` as destinations_d65_multi_direct_114,
    `destinations_srch_destination_id`.`d66` as destinations_d66_multi_direct_115,
    `destinations_srch_destination_id`.`d67` as destinations_d67_multi_direct_116,
    `destinations_srch_destination_id`.`d68` as destinations_d68_multi_direct_117,
    `destinations_srch_destination_id`.`d69` as destinations_d69_multi_direct_118,
    `destinations_srch_destination_id`.`d7` as destinations_d7_multi_direct_119,
    `destinations_srch_destination_id`.`d70` as destinations_d70_multi_direct_120,
    `destinations_srch_destination_id`.`d71` as destinations_d71_multi_direct_121,
    `destinations_srch_destination_id`.`d72` as destinations_d72_multi_direct_122,
    `destinations_srch_destination_id`.`d73` as destinations_d73_multi_direct_123,
    `destinations_srch_destination_id`.`d74` as destinations_d74_multi_direct_124,
    `destinations_srch_destination_id`.`d75` as destinations_d75_multi_direct_125,
    `destinations_srch_destination_id`.`d76` as destinations_d76_multi_direct_126,
    `destinations_srch_destination_id`.`d77` as destinations_d77_multi_direct_127,
    `destinations_srch_destination_id`.`d78` as destinations_d78_multi_direct_128,
    `destinations_srch_destination_id`.`d79` as destinations_d79_multi_direct_129,
    `destinations_srch_destination_id`.`d8` as destinations_d8_multi_direct_130,
    `destinations_srch_destination_id`.`d80` as destinations_d80_multi_direct_131,
    `destinations_srch_destination_id`.`d81` as destinations_d81_multi_direct_132,
    `destinations_srch_destination_id`.`d82` as destinations_d82_multi_direct_133,
    `destinations_srch_destination_id`.`d83` as destinations_d83_multi_direct_134,
    `destinations_srch_destination_id`.`d84` as destinations_d84_multi_direct_135,
    `destinations_srch_destination_id`.`d85` as destinations_d85_multi_direct_136,
    `destinations_srch_destination_id`.`d86` as destinations_d86_multi_direct_137,
    `destinations_srch_destination_id`.`d87` as destinations_d87_multi_direct_138,
    `destinations_srch_destination_id`.`d88` as destinations_d88_multi_direct_139,
    `destinations_srch_destination_id`.`d89` as destinations_d89_multi_direct_140,
    `destinations_srch_destination_id`.`d9` as destinations_d9_multi_direct_141,
    `destinations_srch_destination_id`.`d90` as destinations_d90_multi_direct_142,
    `destinations_srch_destination_id`.`d91` as destinations_d91_multi_direct_143,
    `destinations_srch_destination_id`.`d92` as destinations_d92_multi_direct_144,
    `destinations_srch_destination_id`.`d93` as destinations_d93_multi_direct_145,
    `destinations_srch_destination_id`.`d94` as destinations_d94_multi_direct_146,
    `destinations_srch_destination_id`.`d95` as destinations_d95_multi_direct_147,
    `destinations_srch_destination_id`.`d96` as destinations_d96_multi_direct_148,
    `destinations_srch_destination_id`.`d97` as destinations_d97_multi_direct_149,
    `destinations_srch_destination_id`.`d98` as destinations_d98_multi_direct_150,
    `destinations_srch_destination_id`.`d99` as destinations_d99_multi_direct_151
from
    `train`
    last join `destinations` as `destinations_srch_destination_id` on `train`.`srch_destination_id` = `destinations_srch_destination_id`.`srch_destination_id`)
as out1
on out0.user_id_1 = out1.user_id_4
;