# start sql code
# output table name: sql_table

select
    `Grant_Application_ID` as Grant_Application_ID_1,
    `Start_date` as unimelb_training_Start_date_original_0,
    `Grant_Application_ID` as unimelb_training_Grant_Application_ID_original_1,
    `Grant_Status` as unimelb_training_Grant_Status_original_2,
    `A_1` as unimelb_training_A_1_original_3,
    `A_3` as unimelb_training_A_3_original_4,
    `A_4` as unimelb_training_A_4_original_5,
    `A_5` as unimelb_training_A_5_original_6,
    `A_7` as unimelb_training_A_7_original_7,
    `A_9` as unimelb_training_A_9_original_8,
    `A__1` as unimelb_training_A__1_original_9,
    `A__3` as unimelb_training_A__3_original_10,
    `A__4` as unimelb_training_A__4_original_11,
    `A__5` as unimelb_training_A__5_original_12,
    `A__7` as unimelb_training_A__7_original_13,
    `B_10` as unimelb_training_B_10_original_14,
    `B_13` as unimelb_training_B_13_original_15,
    `B_3` as unimelb_training_B_3_original_16,
    `B_4` as unimelb_training_B_4_original_17,
    `B_7` as unimelb_training_B_7_original_18,
    `B_9` as unimelb_training_B_9_original_19,
    `C_1` as unimelb_training_C_1_original_20,
    `C_11` as unimelb_training_C_11_original_21,
    `C_7` as unimelb_training_C_7_original_22,
    `C_8` as unimelb_training_C_8_original_23,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_original_24,
    `Country_of_Birth_11` as unimelb_training_Country_of_Birth_11_original_25,
    `Country_of_Birth_12` as unimelb_training_Country_of_Birth_12_original_26,
    `Country_of_Birth_13` as unimelb_training_Country_of_Birth_13_original_27,
    `Country_of_Birth_14` as unimelb_training_Country_of_Birth_14_original_28,
    `Country_of_Birth_2` as unimelb_training_Country_of_Birth_2_original_29,
    `Country_of_Birth_3` as unimelb_training_Country_of_Birth_3_original_30,
    `Country_of_Birth_6` as unimelb_training_Country_of_Birth_6_original_31,
    `Country_of_Birth_7` as unimelb_training_Country_of_Birth_7_original_32,
    `Country_of_Birth_8` as unimelb_training_Country_of_Birth_8_original_33,
    `Country_of_Birth_9` as unimelb_training_Country_of_Birth_9_original_34,
    `Dept_No__1` as unimelb_training_Dept_No__1_original_35,
    `Dept_No__10` as unimelb_training_Dept_No__10_original_36,
    `Dept_No__12` as unimelb_training_Dept_No__12_original_37,
    `Dept_No__2` as unimelb_training_Dept_No__2_original_38,
    `Dept_No__3` as unimelb_training_Dept_No__3_original_39,
    `Dept_No__4` as unimelb_training_Dept_No__4_original_40,
    `Dept_No__6` as unimelb_training_Dept_No__6_original_41,
    `Dept_No__7` as unimelb_training_Dept_No__7_original_42,
    `Dept_No__8` as unimelb_training_Dept_No__8_original_43,
    `Dept_No__9` as unimelb_training_Dept_No__9_original_44,
    `Faculty_No__1` as unimelb_training_Faculty_No__1_original_45,
    `Faculty_No__10` as unimelb_training_Faculty_No__10_original_46,
    `Faculty_No__12` as unimelb_training_Faculty_No__12_original_47,
    `Faculty_No__13` as unimelb_training_Faculty_No__13_original_48,
    `Faculty_No__2` as unimelb_training_Faculty_No__2_original_49,
    `Faculty_No__4` as unimelb_training_Faculty_No__4_original_50,
    `Faculty_No__5` as unimelb_training_Faculty_No__5_original_51,
    `Faculty_No__6` as unimelb_training_Faculty_No__6_original_52,
    `Faculty_No__7` as unimelb_training_Faculty_No__7_original_53,
    `Faculty_No__8` as unimelb_training_Faculty_No__8_original_54,
    `Faculty_No__9` as unimelb_training_Faculty_No__9_original_55,
    `Grant_Category_Code` as unimelb_training_Grant_Category_Code_original_56,
    `Home_Language_2` as unimelb_training_Home_Language_2_original_57,
    `No__of_Years_in_Uni_at_Time_of_Grant_1` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_1_original_58,
    `No__of_Years_in_Uni_at_Time_of_Grant_11` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_11_original_59,
    `No__of_Years_in_Uni_at_Time_of_Grant_12` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_12_original_60,
    `No__of_Years_in_Uni_at_Time_of_Grant_13` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_13_original_61,
    `No__of_Years_in_Uni_at_Time_of_Grant_3` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_3_original_62,
    `No__of_Years_in_Uni_at_Time_of_Grant_4` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_4_original_63,
    `No__of_Years_in_Uni_at_Time_of_Grant_5` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_5_original_64,
    `No__of_Years_in_Uni_at_Time_of_Grant_6` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_6_original_65,
    `No__of_Years_in_Uni_at_Time_of_Grant_7` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_7_original_66,
    `No__of_Years_in_Uni_at_Time_of_Grant_8` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_8_original_67,
    `No__of_Years_in_Uni_at_Time_of_Grant_9` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_9_original_68,
    `Number_of_Successful_Grant_1` as unimelb_training_Number_of_Successful_Grant_1_original_69,
    `Number_of_Successful_Grant_2` as unimelb_training_Number_of_Successful_Grant_2_original_70,
    `Number_of_Successful_Grant_3` as unimelb_training_Number_of_Successful_Grant_3_original_71,
    `Number_of_Successful_Grant_5` as unimelb_training_Number_of_Successful_Grant_5_original_72,
    `Number_of_Successful_Grant_7` as unimelb_training_Number_of_Successful_Grant_7_original_73,
    `Number_of_Successful_Grant_9` as unimelb_training_Number_of_Successful_Grant_9_original_74,
    `Number_of_Unsuccessful_Grant_1` as unimelb_training_Number_of_Unsuccessful_Grant_1_original_75,
    `Number_of_Unsuccessful_Grant_10` as unimelb_training_Number_of_Unsuccessful_Grant_10_original_76,
    `Number_of_Unsuccessful_Grant_11` as unimelb_training_Number_of_Unsuccessful_Grant_11_original_77,
    `Number_of_Unsuccessful_Grant_2` as unimelb_training_Number_of_Unsuccessful_Grant_2_original_78,
    `Number_of_Unsuccessful_Grant_3` as unimelb_training_Number_of_Unsuccessful_Grant_3_original_79,
    `Number_of_Unsuccessful_Grant_6` as unimelb_training_Number_of_Unsuccessful_Grant_6_original_80,
    `Number_of_Unsuccessful_Grant_7` as unimelb_training_Number_of_Unsuccessful_Grant_7_original_81,
    `Number_of_Unsuccessful_Grant_8` as unimelb_training_Number_of_Unsuccessful_Grant_8_original_82,
    `Number_of_Unsuccessful_Grant_9` as unimelb_training_Number_of_Unsuccessful_Grant_9_original_83,
    `Person_ID_1` as unimelb_training_Person_ID_1_original_84,
    `Person_ID_2` as unimelb_training_Person_ID_2_original_85,
    `Person_ID_3` as unimelb_training_Person_ID_3_original_86,
    `Person_ID_4` as unimelb_training_Person_ID_4_original_87,
    `Person_ID_5` as unimelb_training_Person_ID_5_original_88,
    `Person_ID_6` as unimelb_training_Person_ID_6_original_89,
    `Person_ID_8` as unimelb_training_Person_ID_8_original_90,
    `RFCD_Code_1` as unimelb_training_RFCD_Code_1_original_91,
    `RFCD_Code_2` as unimelb_training_RFCD_Code_2_original_92,
    `RFCD_Code_3` as unimelb_training_RFCD_Code_3_original_93,
    `RFCD_Code_5` as unimelb_training_RFCD_Code_5_original_94,
    `RFCD_Percentage_1` as unimelb_training_RFCD_Percentage_1_original_95,
    `RFCD_Percentage_2` as unimelb_training_RFCD_Percentage_2_original_96,
    `RFCD_Percentage_3` as unimelb_training_RFCD_Percentage_3_original_97,
    `RFCD_Percentage_4` as unimelb_training_RFCD_Percentage_4_original_98,
    `RFCD_Percentage_5` as unimelb_training_RFCD_Percentage_5_original_99,
    `Role_1` as unimelb_training_Role_1_original_100,
    `Role_10` as unimelb_training_Role_10_original_101,
    `Role_11` as unimelb_training_Role_11_original_102,
    `Role_12` as unimelb_training_Role_12_original_103,
    `Role_13` as unimelb_training_Role_13_original_104,
    `Role_15` as unimelb_training_Role_15_original_105,
    `Role_3` as unimelb_training_Role_3_original_106,
    `Role_4` as unimelb_training_Role_4_original_107,
    `Role_6` as unimelb_training_Role_6_original_108,
    `Role_7` as unimelb_training_Role_7_original_109,
    `Role_8` as unimelb_training_Role_8_original_110,
    `Role_9` as unimelb_training_Role_9_original_111,
    `SEO_Code_1` as unimelb_training_SEO_Code_1_original_112,
    `SEO_Code_2` as unimelb_training_SEO_Code_2_original_113,
    `SEO_Code_3` as unimelb_training_SEO_Code_3_original_114,
    `SEO_Code_4` as unimelb_training_SEO_Code_4_original_115,
    `SEO_Code_5` as unimelb_training_SEO_Code_5_original_116,
    `SEO_Percentage_1` as unimelb_training_SEO_Percentage_1_original_117,
    `SEO_Percentage_2` as unimelb_training_SEO_Percentage_2_original_118,
    `SEO_Percentage_3` as unimelb_training_SEO_Percentage_3_original_119,
    `SEO_Percentage_4` as unimelb_training_SEO_Percentage_4_original_120,
    `SEO_Percentage_5` as unimelb_training_SEO_Percentage_5_original_121,
    `Sponsor_Code` as unimelb_training_Sponsor_Code_original_122,
    `With_PHD_10` as unimelb_training_With_PHD_10_original_123,
    `With_PHD_11` as unimelb_training_With_PHD_11_original_124,
    `With_PHD_12` as unimelb_training_With_PHD_12_original_125,
    `With_PHD_13` as unimelb_training_With_PHD_13_original_126,
    `With_PHD_7` as unimelb_training_With_PHD_7_original_127,
    `With_PHD_8` as unimelb_training_With_PHD_8_original_128,
    `With_PHD_9` as unimelb_training_With_PHD_9_original_129,
    `Year_of_Birth_1` as unimelb_training_Year_of_Birth_1_original_130,
    `Year_of_Birth_10` as unimelb_training_Year_of_Birth_10_original_131,
    `Year_of_Birth_11` as unimelb_training_Year_of_Birth_11_original_132,
    `Year_of_Birth_14` as unimelb_training_Year_of_Birth_14_original_133,
    `Year_of_Birth_2` as unimelb_training_Year_of_Birth_2_original_134,
    `Year_of_Birth_4` as unimelb_training_Year_of_Birth_4_original_135,
    `Year_of_Birth_5` as unimelb_training_Year_of_Birth_5_original_136,
    `Year_of_Birth_6` as unimelb_training_Year_of_Birth_6_original_137,
    `Year_of_Birth_7` as unimelb_training_Year_of_Birth_7_original_138,
    `Year_of_Birth_9` as unimelb_training_Year_of_Birth_9_original_139,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_combine_140,
    `Sponsor_Code` as unimelb_training_Sponsor_Code_combine_140,
    case when !isnull(at(`Grant_Category_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_100 then count_where(`Grant_Category_Code`, `Grant_Category_Code` = at(`Grant_Category_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_100 else null end as unimelb_training_Grant_Category_Code_window_count_141,
    case when !isnull(at(`Sponsor_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_100 then count_where(`Sponsor_Code`, `Sponsor_Code` = at(`Sponsor_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_100 else null end as unimelb_training_Sponsor_Code_window_count_142,
    case when !isnull(at(`Grant_Category_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 then count_where(`Grant_Category_Code`, `Grant_Category_Code` = at(`Grant_Category_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 else null end as unimelb_training_Grant_Category_Code_window_count_143,
    case when !isnull(at(`Sponsor_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 then count_where(`Sponsor_Code`, `Sponsor_Code` = at(`Sponsor_Code`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 else null end as unimelb_training_Sponsor_Code_window_count_144,
    sum(`SEO_Percentage_3`) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_7d_100 as unimelb_training_SEO_Percentage_3_window_sum_145,
    distinct_count(`Number_of_Unsuccessful_Grant_3`) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_200 as unimelb_training_Number_of_Unsuccessful_Grant_3_window_unique_count_146,
    sum(`SEO_Percentage_3`) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 as unimelb_training_SEO_Percentage_3_window_sum_147,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_combine_148,
    `RFCD_Code_2` as unimelb_training_RFCD_Code_2_combine_148,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_combine_149,
    `Grant_Category_Code` as unimelb_training_Grant_Category_Code_combine_149,
    fz_top1_ratio(`Contract_Value_Band___see_note_A`) over unimelb_training_Person_ID_1_Start_date_0s_2d_200 as unimelb_training_Contract_Value_Band___see_note_A_window_top1_ratio_150,
    `Grant_Category_Code` as unimelb_training_Grant_Category_Code_combine_151,
    `Number_of_Successful_Grant_1` as unimelb_training_Number_of_Successful_Grant_1_combine_151,
    fz_top1_ratio(`Contract_Value_Band___see_note_A`) over unimelb_training_Person_ID_1_Start_date_0s_7d_200 as unimelb_training_Contract_Value_Band___see_note_A_window_top1_ratio_152,
    `Number_of_Successful_Grant_1` as unimelb_training_Number_of_Successful_Grant_1_combine_153,
    `Number_of_Unsuccessful_Grant_1` as unimelb_training_Number_of_Unsuccessful_Grant_1_combine_153,
    distinct_count(`Contract_Value_Band___see_note_A`) over unimelb_training_Person_ID_1_Start_date_0s_5d_100 as unimelb_training_Contract_Value_Band___see_note_A_window_unique_count_154,
    distinct_count(`Contract_Value_Band___see_note_A`) over unimelb_training_Person_ID_1_Start_date_0s_7d_100 as unimelb_training_Contract_Value_Band___see_note_A_window_unique_count_155,
    distinct_count(`Contract_Value_Band___see_note_A`) over unimelb_training_RFCD_Code_1_Start_date_0s_2d_100 as unimelb_training_Contract_Value_Band___see_note_A_window_unique_count_156,
    distinct_count(`Contract_Value_Band___see_note_A`) over unimelb_training_RFCD_Code_1_Start_date_0s_7d_200 as unimelb_training_Contract_Value_Band___see_note_A_window_unique_count_157
from
    `unimelb_training`
    window unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_100 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 64d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 14d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_7d_100 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 7d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_64d_200 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 64d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_Person_ID_1_Start_date_0s_2d_200 as (partition by `Person_ID_1` order by `Start_date` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_Person_ID_1_Start_date_0s_7d_200 as (partition by `Person_ID_1` order by `Start_date` rows_range between 7d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_Person_ID_1_Start_date_0s_5d_100 as (partition by `Person_ID_1` order by `Start_date` rows_range between 5d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Person_ID_1_Start_date_0s_7d_100 as (partition by `Person_ID_1` order by `Start_date` rows_range between 7d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_RFCD_Code_1_Start_date_0s_2d_100 as (partition by `RFCD_Code_1` order by `Start_date` rows_range between 2d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_RFCD_Code_1_Start_date_0s_7d_200 as (partition by `RFCD_Code_1` order by `Start_date` rows_range between 7d open preceding and 0s preceding MAXSIZE 200);