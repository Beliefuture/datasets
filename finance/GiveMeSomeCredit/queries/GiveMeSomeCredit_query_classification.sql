# start sql code
# output table name: sql_table

select
    `id` as id_1,
    `timestamp` as cs-training_timestamp_original_0,
    `id` as cs-training_id_original_1,
    `SeriousDlqin2yrs` as cs-training_SeriousDlqin2yrs_original_2,
    `DebtRatio` as cs-training_DebtRatio_original_3,
    `MonthlyIncome` as cs-training_MonthlyIncome_original_4,
    `NumberOfDependents` as cs-training_NumberOfDependents_original_5,
    `NumberOfOpenCreditLinesAndLoans` as cs-training_NumberOfOpenCreditLinesAndLoans_original_6,
    `NumberOfTime30-59DaysPastDueNotWorse` as cs-training_NumberOfTime30-59DaysPastDueNotWorse_original_7,
    `NumberOfTime60-89DaysPastDueNotWorse` as cs-training_NumberOfTime60-89DaysPastDueNotWorse_original_8,
    `NumberOfTimes90DaysLate` as cs-training_NumberOfTimes90DaysLate_original_9,
    `NumberRealEstateLoansOrLines` as cs-training_NumberRealEstateLoansOrLines_original_10,
    `age` as cs-training_age_original_11,
    log(`DebtRatio`) as cs-training_DebtRatio_log_12,
    case when !isnull(at(`NumberRealEstateLoansOrLines`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_200 then count_where(`NumberRealEstateLoansOrLines`, `NumberRealEstateLoansOrLines` = at(`NumberRealEstateLoansOrLines`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_200 else null end as cs-training_NumberRealEstateLoansOrLines_window_count_13,
    fz_top1_ratio(`MonthlyIncome`) over cs-training_age_timestamp_0s_1h_200 as cs-training_MonthlyIncome_window_top1_ratio_14,
    `age` as cs-training_age_combine_15,
    `NumberOfTime60-89DaysPastDueNotWorse` as cs-training_NumberOfTime60-89DaysPastDueNotWorse_combine_15,
    fz_top1_ratio(`NumberOfTime30-59DaysPastDueNotWorse`) over cs-training_age_timestamp_0s_1h_100 as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_top1_ratio_16,
    distinct_count(`NumberOfDependents`) over cs-training_age_timestamp_0s_1h_200 as cs-training_NumberOfDependents_window_unique_count_17,
    case when !isnull(at(`NumberOfTimes90DaysLate`, 0)) over cs-training_age_timestamp_0s_1h_100 then count_where(`NumberOfTimes90DaysLate`, `NumberOfTimes90DaysLate` = at(`NumberOfTimes90DaysLate`, 0)) over cs-training_age_timestamp_0s_1h_100 else null end as cs-training_NumberOfTimes90DaysLate_window_count_18,
    `NumberOfTimes90DaysLate` as cs-training_NumberOfTimes90DaysLate_combine_19,
    `NumberOfTime60-89DaysPastDueNotWorse` as cs-training_NumberOfTime60-89DaysPastDueNotWorse_combine_19,
    `NumberRealEstateLoansOrLines` as cs-training_NumberRealEstateLoansOrLines_combine_19,
    fz_top1_ratio(`NumberOfTime30-59DaysPastDueNotWorse`) over cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_100 as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_top1_ratio_20,
    case when !isnull(at(`NumberOfTimes90DaysLate`, 0)) over cs-training_NumberOfTime30-59DaysPastDueNotWorse_timestamp_0s_1h_100 then count_where(`NumberOfTimes90DaysLate`, `NumberOfTimes90DaysLate` = at(`NumberOfTimes90DaysLate`, 0)) over cs-training_NumberOfTime30-59DaysPastDueNotWorse_timestamp_0s_1h_100 else null end as cs-training_NumberOfTimes90DaysLate_window_count_21,
    `NumberOfTime30-59DaysPastDueNotWorse` as cs-training_NumberOfTime30-59DaysPastDueNotWorse_combine_22,
    `NumberOfTime60-89DaysPastDueNotWorse` as cs-training_NumberOfTime60-89DaysPastDueNotWorse_combine_22,
    `NumberOfOpenCreditLinesAndLoans` as cs-training_NumberOfOpenCreditLinesAndLoans_combine_22,
    `NumberOfTime30-59DaysPastDueNotWorse` as cs-training_NumberOfTime30-59DaysPastDueNotWorse_combine_23,
    `NumberOfTimes90DaysLate` as cs-training_NumberOfTimes90DaysLate_combine_23,
    `NumberOfTime60-89DaysPastDueNotWorse` as cs-training_NumberOfTime60-89DaysPastDueNotWorse_combine_23,
    case when !isnull(at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_100 then count_where(`NumberOfTime30-59DaysPastDueNotWorse`, `NumberOfTime30-59DaysPastDueNotWorse` = at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_100 else null end as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_count_24,
    `NumberOfTime30-59DaysPastDueNotWorse` as cs-training_NumberOfTime30-59DaysPastDueNotWorse_combine_25,
    `NumberOfTimes90DaysLate` as cs-training_NumberOfTimes90DaysLate_combine_25,
    `NumberOfDependents` as cs-training_NumberOfDependents_combine_25,
    case when !isnull(at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0_10_ then count_where(`NumberOfTime30-59DaysPastDueNotWorse`, `NumberOfTime30-59DaysPastDueNotWorse` = at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0_10_ else null end as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_count_26,
    `NumberOfTime30-59DaysPastDueNotWorse` as cs-training_NumberOfTime30-59DaysPastDueNotWorse_combine_27,
    `NumberOfTimes90DaysLate` as cs-training_NumberOfTimes90DaysLate_combine_27,
    case when !isnull(at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfDependents_timestamp_0_10_ then count_where(`NumberOfTime30-59DaysPastDueNotWorse`, `NumberOfTime30-59DaysPastDueNotWorse` = at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfDependents_timestamp_0_10_ else null end as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_count_28,
    case when !isnull(at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfDependents_timestamp_0s_1h_100 then count_where(`NumberOfTime30-59DaysPastDueNotWorse`, `NumberOfTime30-59DaysPastDueNotWorse` = at(`NumberOfTime30-59DaysPastDueNotWorse`, 0)) over cs-training_NumberOfDependents_timestamp_0s_1h_100 else null end as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_count_29
from
    `cs-training`
    window cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_200 as (partition by `NumberOfTimes90DaysLate` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    cs-training_age_timestamp_0s_1h_200 as (partition by `age` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    cs-training_age_timestamp_0s_1h_100 as (partition by `age` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_100 as (partition by `NumberOfOpenCreditLinesAndLoans` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfTime30-59DaysPastDueNotWorse_timestamp_0s_1h_100 as (partition by `NumberOfTime30-59DaysPastDueNotWorse` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_100 as (partition by `NumberOfTimes90DaysLate` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfTimes90DaysLate_timestamp_0_10_ as (partition by `NumberOfTimes90DaysLate` order by `timestamp` rows between 10 open preceding and 0 preceding),
    cs-training_NumberOfDependents_timestamp_0_10_ as (partition by `NumberOfDependents` order by `timestamp` rows between 10 open preceding and 0 preceding),
    cs-training_NumberOfDependents_timestamp_0s_1h_100 as (partition by `NumberOfDependents` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100);