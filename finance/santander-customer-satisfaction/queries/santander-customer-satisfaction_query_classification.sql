# start sql code
# output table name: sql_table

select
    `id` as id_1,
    `timestamp` as train_timestamp_original_0,
    `id` as train_id_original_1,
    `TARGET` as train_TARGET_original_2,
    `delta_imp_aport_var13_1y3` as train_delta_imp_aport_var13_1y3_original_3,
    `delta_imp_compra_var44_1y3` as train_delta_imp_compra_var44_1y3_original_4,
    `delta_imp_reemb_var13_1y3` as train_delta_imp_reemb_var13_1y3_original_5,
    `delta_num_aport_var13_1y3` as train_delta_num_aport_var13_1y3_original_6,
    `delta_num_compra_var44_1y3` as train_delta_num_compra_var44_1y3_original_7,
    `delta_num_reemb_var13_1y3` as train_delta_num_reemb_var13_1y3_original_8,
    `imp_compra_var44_ult1` as train_imp_compra_var44_ult1_original_9,
    `imp_op_var39_comer_ult1` as train_imp_op_var39_comer_ult1_original_10,
    `imp_op_var39_comer_ult3` as train_imp_op_var39_comer_ult3_original_11,
    `imp_op_var39_efect_ult1` as train_imp_op_var39_efect_ult1_original_12,
    `imp_op_var39_efect_ult3` as train_imp_op_var39_efect_ult3_original_13,
    `imp_op_var39_ult1` as train_imp_op_var39_ult1_original_14,
    `imp_op_var40_comer_ult1` as train_imp_op_var40_comer_ult1_original_15,
    `imp_op_var40_comer_ult3` as train_imp_op_var40_comer_ult3_original_16,
    `imp_op_var40_efect_ult1` as train_imp_op_var40_efect_ult1_original_17,
    `imp_op_var40_efect_ult3` as train_imp_op_var40_efect_ult3_original_18,
    `imp_op_var40_ult1` as train_imp_op_var40_ult1_original_19,
    `imp_op_var41_comer_ult1` as train_imp_op_var41_comer_ult1_original_20,
    `imp_op_var41_comer_ult3` as train_imp_op_var41_comer_ult3_original_21,
    `imp_op_var41_efect_ult1` as train_imp_op_var41_efect_ult1_original_22,
    `imp_op_var41_efect_ult3` as train_imp_op_var41_efect_ult3_original_23,
    `imp_op_var41_ult1` as train_imp_op_var41_ult1_original_24,
    `imp_reemb_var13_ult1` as train_imp_reemb_var13_ult1_original_25,
    `imp_sal_var16_ult1` as train_imp_sal_var16_ult1_original_26,
    `ind_var1` as train_ind_var1_original_27,
    `ind_var10_ult1` as train_ind_var10_ult1_original_28,
    `ind_var10cte_ult1` as train_ind_var10cte_ult1_original_29,
    `ind_var12` as train_ind_var12_original_30,
    `ind_var12_0` as train_ind_var12_0_original_31,
    `ind_var13` as train_ind_var13_original_32,
    `ind_var13_0` as train_ind_var13_0_original_33,
    `ind_var13_corto` as train_ind_var13_corto_original_34,
    `ind_var13_corto_0` as train_ind_var13_corto_0_original_35,
    `ind_var13_largo` as train_ind_var13_largo_original_36,
    `ind_var13_largo_0` as train_ind_var13_largo_0_original_37,
    `ind_var14` as train_ind_var14_original_38,
    `ind_var14_0` as train_ind_var14_0_original_39,
    `ind_var19` as train_ind_var19_original_40,
    `ind_var20` as train_ind_var20_original_41,
    `ind_var20_0` as train_ind_var20_0_original_42,
    `ind_var24` as train_ind_var24_original_43,
    `ind_var24_0` as train_ind_var24_0_original_44,
    `ind_var25` as train_ind_var25_original_45,
    `ind_var25_0` as train_ind_var25_0_original_46,
    `ind_var25_cte` as train_ind_var25_cte_original_47,
    `ind_var26` as train_ind_var26_original_48,
    `ind_var26_0` as train_ind_var26_0_original_49,
    `ind_var26_cte` as train_ind_var26_cte_original_50,
    `ind_var30` as train_ind_var30_original_51,
    `ind_var37` as train_ind_var37_original_52,
    `ind_var37_0` as train_ind_var37_0_original_53,
    `ind_var39` as train_ind_var39_original_54,
    `ind_var39_0` as train_ind_var39_0_original_55,
    `ind_var40` as train_ind_var40_original_56,
    `ind_var41_0` as train_ind_var41_0_original_57,
    `ind_var43_emit_ult1` as train_ind_var43_emit_ult1_original_58,
    `ind_var43_recib_ult1` as train_ind_var43_recib_ult1_original_59,
    `ind_var5` as train_ind_var5_original_60,
    `ind_var5_0` as train_ind_var5_0_original_61,
    `ind_var8` as train_ind_var8_original_62,
    `ind_var8_0` as train_ind_var8_0_original_63,
    `ind_var9_cte_ult1` as train_ind_var9_cte_ult1_original_64,
    `ind_var9_ult1` as train_ind_var9_ult1_original_65,
    `num_aport_var13_hace3` as train_num_aport_var13_hace3_original_66,
    `num_ent_var16_ult1` as train_num_ent_var16_ult1_original_67,
    `num_med_var45_ult3` as train_num_med_var45_ult3_original_68,
    `num_meses_var12_ult3` as train_num_meses_var12_ult3_original_69,
    `num_meses_var13_corto_ult3` as train_num_meses_var13_corto_ult3_original_70,
    `num_meses_var39_vig_ult3` as train_num_meses_var39_vig_ult3_original_71,
    `num_meses_var5_ult3` as train_num_meses_var5_ult3_original_72,
    `num_meses_var8_ult3` as train_num_meses_var8_ult3_original_73,
    `num_op_var39_comer_ult1` as train_num_op_var39_comer_ult1_original_74,
    `num_op_var39_comer_ult3` as train_num_op_var39_comer_ult3_original_75,
    `num_op_var39_efect_ult3` as train_num_op_var39_efect_ult3_original_76,
    `num_op_var39_hace2` as train_num_op_var39_hace2_original_77,
    `num_op_var39_ult1` as train_num_op_var39_ult1_original_78,
    `num_op_var39_ult3` as train_num_op_var39_ult3_original_79,
    `num_op_var40_comer_ult1` as train_num_op_var40_comer_ult1_original_80,
    `num_op_var40_comer_ult3` as train_num_op_var40_comer_ult3_original_81,
    `num_op_var40_efect_ult1` as train_num_op_var40_efect_ult1_original_82,
    `num_op_var40_efect_ult3` as train_num_op_var40_efect_ult3_original_83,
    `num_op_var40_ult1` as train_num_op_var40_ult1_original_84,
    `num_op_var40_ult3` as train_num_op_var40_ult3_original_85,
    `num_op_var41_comer_ult1` as train_num_op_var41_comer_ult1_original_86,
    `num_op_var41_comer_ult3` as train_num_op_var41_comer_ult3_original_87,
    `num_op_var41_efect_ult3` as train_num_op_var41_efect_ult3_original_88,
    `num_op_var41_hace2` as train_num_op_var41_hace2_original_89,
    `num_op_var41_ult1` as train_num_op_var41_ult1_original_90,
    `num_op_var41_ult3` as train_num_op_var41_ult3_original_91,
    `num_reemb_var13_ult1` as train_num_reemb_var13_ult1_original_92,
    `num_sal_var16_ult1` as train_num_sal_var16_ult1_original_93,
    `num_trasp_var11_ult1` as train_num_trasp_var11_ult1_original_94,
    `num_var1` as train_num_var1_original_95,
    `num_var12` as train_num_var12_original_96,
    `num_var12_0` as train_num_var12_0_original_97,
    `num_var13` as train_num_var13_original_98,
    `num_var13_corto` as train_num_var13_corto_original_99,
    `num_var13_corto_0` as train_num_var13_corto_0_original_100,
    `num_var13_largo_0` as train_num_var13_largo_0_original_101,
    `num_var14` as train_num_var14_original_102,
    `num_var14_0` as train_num_var14_0_original_103,
    `num_var20` as train_num_var20_original_104,
    `num_var20_0` as train_num_var20_0_original_105,
    `num_var22_hace2` as train_num_var22_hace2_original_106,
    `num_var22_hace3` as train_num_var22_hace3_original_107,
    `num_var22_ult1` as train_num_var22_ult1_original_108,
    `num_var22_ult3` as train_num_var22_ult3_original_109,
    `num_var24` as train_num_var24_original_110,
    `num_var24_0` as train_num_var24_0_original_111,
    `num_var25` as train_num_var25_original_112,
    `num_var25_0` as train_num_var25_0_original_113,
    `num_var26` as train_num_var26_original_114,
    `num_var26_0` as train_num_var26_0_original_115,
    `num_var30` as train_num_var30_original_116,
    `num_var30_0` as train_num_var30_0_original_117,
    `num_var31` as train_num_var31_original_118,
    `num_var31_0` as train_num_var31_0_original_119,
    `num_var35` as train_num_var35_original_120,
    `num_var37` as train_num_var37_original_121,
    `num_var37_0` as train_num_var37_0_original_122,
    `num_var37_med_ult2` as train_num_var37_med_ult2_original_123,
    `num_var39` as train_num_var39_original_124,
    `num_var39_0` as train_num_var39_0_original_125,
    `num_var4` as train_num_var4_original_126,
    `num_var40` as train_num_var40_original_127,
    `num_var41_0` as train_num_var41_0_original_128,
    `num_var42` as train_num_var42_original_129,
    `num_var42_0` as train_num_var42_0_original_130,
    `num_var43_emit_ult1` as train_num_var43_emit_ult1_original_131,
    `num_var43_recib_ult1` as train_num_var43_recib_ult1_original_132,
    `num_var45_hace2` as train_num_var45_hace2_original_133,
    `num_var45_hace3` as train_num_var45_hace3_original_134,
    `num_var45_ult1` as train_num_var45_ult1_original_135,
    `num_var45_ult3` as train_num_var45_ult3_original_136,
    `num_var5` as train_num_var5_original_137,
    `num_var7_recib_ult1` as train_num_var7_recib_ult1_original_138,
    `num_var8` as train_num_var8_original_139,
    `num_var8_0` as train_num_var8_0_original_140,
    `saldo_medio_var12_hace2` as train_saldo_medio_var12_hace2_original_141,
    `saldo_medio_var12_ult1` as train_saldo_medio_var12_ult1_original_142,
    `saldo_medio_var12_ult3` as train_saldo_medio_var12_ult3_original_143,
    `saldo_medio_var44_ult1` as train_saldo_medio_var44_ult1_original_144,
    `saldo_medio_var5_hace2` as train_saldo_medio_var5_hace2_original_145,
    `saldo_medio_var5_hace3` as train_saldo_medio_var5_hace3_original_146,
    `saldo_medio_var5_ult1` as train_saldo_medio_var5_ult1_original_147,
    `saldo_medio_var5_ult3` as train_saldo_medio_var5_ult3_original_148,
    `saldo_medio_var8_ult3` as train_saldo_medio_var8_ult3_original_149,
    `saldo_var12` as train_saldo_var12_original_150,
    `saldo_var13` as train_saldo_var13_original_151,
    `saldo_var24` as train_saldo_var24_original_152,
    `saldo_var25` as train_saldo_var25_original_153,
    `saldo_var26` as train_saldo_var26_original_154,
    `saldo_var30` as train_saldo_var30_original_155,
    `saldo_var37` as train_saldo_var37_original_156,
    `saldo_var40` as train_saldo_var40_original_157,
    `saldo_var42` as train_saldo_var42_original_158,
    `saldo_var5` as train_saldo_var5_original_159,
    `var15` as train_var15_original_160,
    `var21` as train_var21_original_161,
    `var36` as train_var36_original_162,
    `var38` as train_var38_original_163,
    case when !isnull(at(`var15`, 0)) over train_num_var45_hace2_timestamp_0s_1h_200 then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_var45_hace2_timestamp_0s_1h_200 else null end as train_var15_window_count_164,
    case when !isnull(at(`var15`, 0)) over train_num_var39_0_timestamp_0s_1h_200 then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_var39_0_timestamp_0s_1h_200 else null end as train_var15_window_count_165,
    fz_top1_ratio(`num_var45_hace3`) over train_var15_timestamp_0s_1h_200 as train_num_var45_hace3_window_top1_ratio_166,
    case when !isnull(at(`var15`, 0)) over train_num_var45_ult3_timestamp_0s_1h_100 then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_var45_ult3_timestamp_0s_1h_100 else null end as train_var15_window_count_167,
    case when !isnull(at(`var15`, 0)) over train_var36_timestamp_0s_1h_100 then count_where(`var15`, `var15` = at(`var15`, 0)) over train_var36_timestamp_0s_1h_100 else null end as train_var15_window_count_168,
    case when !isnull(at(`var15`, 0)) over train_num_meses_var39_vig_ult3_timestamp_0s_1h_200 then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_meses_var39_vig_ult3_timestamp_0s_1h_200 else null end as train_var15_window_count_169,
    case when !isnull(at(`var15`, 0)) over train_num_var35_timestamp_0s_1h_100 then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_var35_timestamp_0s_1h_100 else null end as train_var15_window_count_170,
    case when !isnull(at(`var15`, 0)) over train_num_med_var45_ult3_timestamp_0_10_ then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_med_var45_ult3_timestamp_0_10_ else null end as train_var15_window_count_171,
    case when !isnull(at(`var15`, 0)) over train_num_var45_hace2_timestamp_0_10_ then count_where(`var15`, `var15` = at(`var15`, 0)) over train_num_var45_hace2_timestamp_0_10_ else null end as train_var15_window_count_172,
    log(`saldo_var42`) as train_saldo_var42_log_173,
    log(`saldo_var30`) as train_saldo_var30_log_174,
    log(`saldo_medio_var5_ult3`) as train_saldo_medio_var5_ult3_log_175,
    log(`var38`) as train_var38_log_176,
    log(`saldo_medio_var5_hace2`) as train_saldo_medio_var5_hace2_log_177,
    log(`saldo_medio_var5_ult1`) as train_saldo_medio_var5_ult1_log_178,
    log(`saldo_var5`) as train_saldo_var5_log_179,
    `imp_op_var39_comer_ult3` as train_imp_op_var39_comer_ult3_divide_180,
    `saldo_medio_var5_ult3` as train_saldo_medio_var5_ult3_divide_180,
    `imp_op_var39_comer_ult3` as train_imp_op_var39_comer_ult3_divide_181,
    `saldo_medio_var5_ult1` as train_saldo_medio_var5_ult1_divide_181
from
    `train`
    window train_num_var45_hace2_timestamp_0s_1h_200 as (partition by `num_var45_hace2` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_num_var39_0_timestamp_0s_1h_200 as (partition by `num_var39_0` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_var15_timestamp_0s_1h_200 as (partition by `var15` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_num_var45_ult3_timestamp_0s_1h_100 as (partition by `num_var45_ult3` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    train_var36_timestamp_0s_1h_100 as (partition by `var36` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    train_num_meses_var39_vig_ult3_timestamp_0s_1h_200 as (partition by `num_meses_var39_vig_ult3` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    train_num_var35_timestamp_0s_1h_100 as (partition by `num_var35` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    train_num_med_var45_ult3_timestamp_0_10_ as (partition by `num_med_var45_ult3` order by `timestamp` rows between 10 open preceding and 0 preceding),
    train_num_var45_hace2_timestamp_0_10_ as (partition by `num_var45_hace2` order by `timestamp` rows between 10 open preceding and 0 preceding);