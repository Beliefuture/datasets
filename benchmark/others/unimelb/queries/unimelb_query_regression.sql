# start sql code
# output table name: sql_table

select
    `Grant_Application_ID` as Grant_Application_ID_1,
    `Start_date` as unimelb_training_Start_date_original_0,
    `Grant_Application_ID` as unimelb_training_Grant_Application_ID_original_1,
    `Grant_Status` as unimelb_training_Grant_Status_original_2,
    `A_1` as unimelb_training_A_1_original_3,
    `A_10` as unimelb_training_A_10_original_4,
    `A_11` as unimelb_training_A_11_original_5,
    `A_13` as unimelb_training_A_13_original_6,
    `A_15` as unimelb_training_A_15_original_7,
    `A_2` as unimelb_training_A_2_original_8,
    `A_3` as unimelb_training_A_3_original_9,
    `A_4` as unimelb_training_A_4_original_10,
    `A_5` as unimelb_training_A_5_original_11,
    `A_6` as unimelb_training_A_6_original_12,
    `A_7` as unimelb_training_A_7_original_13,
    `A_8` as unimelb_training_A_8_original_14,
    `A_9` as unimelb_training_A_9_original_15,
    `A__1` as unimelb_training_A__1_original_16,
    `A__10` as unimelb_training_A__10_original_17,
    `A__2` as unimelb_training_A__2_original_18,
    `A__3` as unimelb_training_A__3_original_19,
    `A__4` as unimelb_training_A__4_original_20,
    `A__5` as unimelb_training_A__5_original_21,
    `A__6` as unimelb_training_A__6_original_22,
    `A__7` as unimelb_training_A__7_original_23,
    `A__8` as unimelb_training_A__8_original_24,
    `A__9` as unimelb_training_A__9_original_25,
    `B_1` as unimelb_training_B_1_original_26,
    `B_10` as unimelb_training_B_10_original_27,
    `B_13` as unimelb_training_B_13_original_28,
    `B_2` as unimelb_training_B_2_original_29,
    `B_3` as unimelb_training_B_3_original_30,
    `B_4` as unimelb_training_B_4_original_31,
    `B_5` as unimelb_training_B_5_original_32,
    `B_6` as unimelb_training_B_6_original_33,
    `B_7` as unimelb_training_B_7_original_34,
    `B_8` as unimelb_training_B_8_original_35,
    `B_9` as unimelb_training_B_9_original_36,
    `C_1` as unimelb_training_C_1_original_37,
    `C_11` as unimelb_training_C_11_original_38,
    `C_2` as unimelb_training_C_2_original_39,
    `C_3` as unimelb_training_C_3_original_40,
    `C_4` as unimelb_training_C_4_original_41,
    `C_5` as unimelb_training_C_5_original_42,
    `C_6` as unimelb_training_C_6_original_43,
    `C_7` as unimelb_training_C_7_original_44,
    `C_8` as unimelb_training_C_8_original_45,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_original_46,
    `Country_of_Birth_1` as unimelb_training_Country_of_Birth_1_original_47,
    `Country_of_Birth_11` as unimelb_training_Country_of_Birth_11_original_48,
    `Country_of_Birth_12` as unimelb_training_Country_of_Birth_12_original_49,
    `Country_of_Birth_13` as unimelb_training_Country_of_Birth_13_original_50,
    `Country_of_Birth_2` as unimelb_training_Country_of_Birth_2_original_51,
    `Country_of_Birth_3` as unimelb_training_Country_of_Birth_3_original_52,
    `Country_of_Birth_4` as unimelb_training_Country_of_Birth_4_original_53,
    `Country_of_Birth_5` as unimelb_training_Country_of_Birth_5_original_54,
    `Country_of_Birth_6` as unimelb_training_Country_of_Birth_6_original_55,
    `Country_of_Birth_7` as unimelb_training_Country_of_Birth_7_original_56,
    `Country_of_Birth_8` as unimelb_training_Country_of_Birth_8_original_57,
    `Country_of_Birth_9` as unimelb_training_Country_of_Birth_9_original_58,
    `Dept_No__1` as unimelb_training_Dept_No__1_original_59,
    `Dept_No__12` as unimelb_training_Dept_No__12_original_60,
    `Dept_No__2` as unimelb_training_Dept_No__2_original_61,
    `Dept_No__3` as unimelb_training_Dept_No__3_original_62,
    `Dept_No__4` as unimelb_training_Dept_No__4_original_63,
    `Dept_No__6` as unimelb_training_Dept_No__6_original_64,
    `Dept_No__7` as unimelb_training_Dept_No__7_original_65,
    `Dept_No__8` as unimelb_training_Dept_No__8_original_66,
    `Dept_No__9` as unimelb_training_Dept_No__9_original_67,
    `Faculty_No__1` as unimelb_training_Faculty_No__1_original_68,
    `Faculty_No__2` as unimelb_training_Faculty_No__2_original_69,
    `Faculty_No__3` as unimelb_training_Faculty_No__3_original_70,
    `Faculty_No__4` as unimelb_training_Faculty_No__4_original_71,
    `Faculty_No__5` as unimelb_training_Faculty_No__5_original_72,
    `Faculty_No__6` as unimelb_training_Faculty_No__6_original_73,
    `Faculty_No__7` as unimelb_training_Faculty_No__7_original_74,
    `Faculty_No__8` as unimelb_training_Faculty_No__8_original_75,
    `Faculty_No__9` as unimelb_training_Faculty_No__9_original_76,
    `Grant_Category_Code` as unimelb_training_Grant_Category_Code_original_77,
    `Home_Language_1` as unimelb_training_Home_Language_1_original_78,
    `Home_Language_2` as unimelb_training_Home_Language_2_original_79,
    `Home_Language_3` as unimelb_training_Home_Language_3_original_80,
    `Home_Language_4` as unimelb_training_Home_Language_4_original_81,
    `Home_Language_5` as unimelb_training_Home_Language_5_original_82,
    `Home_Language_6` as unimelb_training_Home_Language_6_original_83,
    `Home_Language_7` as unimelb_training_Home_Language_7_original_84,
    `Home_Language_8` as unimelb_training_Home_Language_8_original_85,
    `Home_Language_9` as unimelb_training_Home_Language_9_original_86,
    `No__of_Years_in_Uni_at_Time_of_Grant_1` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_1_original_87,
    `No__of_Years_in_Uni_at_Time_of_Grant_11` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_11_original_88,
    `No__of_Years_in_Uni_at_Time_of_Grant_12` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_12_original_89,
    `No__of_Years_in_Uni_at_Time_of_Grant_2` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_2_original_90,
    `No__of_Years_in_Uni_at_Time_of_Grant_3` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_3_original_91,
    `No__of_Years_in_Uni_at_Time_of_Grant_4` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_4_original_92,
    `No__of_Years_in_Uni_at_Time_of_Grant_5` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_5_original_93,
    `No__of_Years_in_Uni_at_Time_of_Grant_6` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_6_original_94,
    `No__of_Years_in_Uni_at_Time_of_Grant_7` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_7_original_95,
    `No__of_Years_in_Uni_at_Time_of_Grant_8` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_8_original_96,
    `No__of_Years_in_Uni_at_Time_of_Grant_9` as unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_9_original_97,
    `Number_of_Successful_Grant_1` as unimelb_training_Number_of_Successful_Grant_1_original_98,
    `Number_of_Successful_Grant_10` as unimelb_training_Number_of_Successful_Grant_10_original_99,
    `Number_of_Successful_Grant_2` as unimelb_training_Number_of_Successful_Grant_2_original_100,
    `Number_of_Successful_Grant_3` as unimelb_training_Number_of_Successful_Grant_3_original_101,
    `Number_of_Successful_Grant_4` as unimelb_training_Number_of_Successful_Grant_4_original_102,
    `Number_of_Successful_Grant_5` as unimelb_training_Number_of_Successful_Grant_5_original_103,
    `Number_of_Successful_Grant_6` as unimelb_training_Number_of_Successful_Grant_6_original_104,
    `Number_of_Successful_Grant_7` as unimelb_training_Number_of_Successful_Grant_7_original_105,
    `Number_of_Successful_Grant_8` as unimelb_training_Number_of_Successful_Grant_8_original_106,
    `Number_of_Unsuccessful_Grant_1` as unimelb_training_Number_of_Unsuccessful_Grant_1_original_107,
    `Number_of_Unsuccessful_Grant_2` as unimelb_training_Number_of_Unsuccessful_Grant_2_original_108,
    `Number_of_Unsuccessful_Grant_3` as unimelb_training_Number_of_Unsuccessful_Grant_3_original_109,
    `Number_of_Unsuccessful_Grant_4` as unimelb_training_Number_of_Unsuccessful_Grant_4_original_110,
    `Number_of_Unsuccessful_Grant_5` as unimelb_training_Number_of_Unsuccessful_Grant_5_original_111,
    `Number_of_Unsuccessful_Grant_6` as unimelb_training_Number_of_Unsuccessful_Grant_6_original_112,
    `Number_of_Unsuccessful_Grant_7` as unimelb_training_Number_of_Unsuccessful_Grant_7_original_113,
    `Number_of_Unsuccessful_Grant_8` as unimelb_training_Number_of_Unsuccessful_Grant_8_original_114,
    `Number_of_Unsuccessful_Grant_9` as unimelb_training_Number_of_Unsuccessful_Grant_9_original_115,
    `Person_ID_1` as unimelb_training_Person_ID_1_original_116,
    `Person_ID_2` as unimelb_training_Person_ID_2_original_117,
    `Person_ID_3` as unimelb_training_Person_ID_3_original_118,
    `Person_ID_4` as unimelb_training_Person_ID_4_original_119,
    `Person_ID_5` as unimelb_training_Person_ID_5_original_120,
    `Person_ID_6` as unimelb_training_Person_ID_6_original_121,
    `Person_ID_7` as unimelb_training_Person_ID_7_original_122,
    `Person_ID_8` as unimelb_training_Person_ID_8_original_123,
    `Person_ID_9` as unimelb_training_Person_ID_9_original_124,
    `RFCD_Code_1` as unimelb_training_RFCD_Code_1_original_125,
    `RFCD_Code_2` as unimelb_training_RFCD_Code_2_original_126,
    `RFCD_Code_3` as unimelb_training_RFCD_Code_3_original_127,
    `RFCD_Code_4` as unimelb_training_RFCD_Code_4_original_128,
    `RFCD_Code_5` as unimelb_training_RFCD_Code_5_original_129,
    `RFCD_Percentage_1` as unimelb_training_RFCD_Percentage_1_original_130,
    `RFCD_Percentage_2` as unimelb_training_RFCD_Percentage_2_original_131,
    `RFCD_Percentage_3` as unimelb_training_RFCD_Percentage_3_original_132,
    `RFCD_Percentage_4` as unimelb_training_RFCD_Percentage_4_original_133,
    `RFCD_Percentage_5` as unimelb_training_RFCD_Percentage_5_original_134,
    `Role_1` as unimelb_training_Role_1_original_135,
    `Role_10` as unimelb_training_Role_10_original_136,
    `Role_11` as unimelb_training_Role_11_original_137,
    `Role_12` as unimelb_training_Role_12_original_138,
    `Role_13` as unimelb_training_Role_13_original_139,
    `Role_15` as unimelb_training_Role_15_original_140,
    `Role_2` as unimelb_training_Role_2_original_141,
    `Role_3` as unimelb_training_Role_3_original_142,
    `Role_4` as unimelb_training_Role_4_original_143,
    `Role_5` as unimelb_training_Role_5_original_144,
    `Role_6` as unimelb_training_Role_6_original_145,
    `Role_7` as unimelb_training_Role_7_original_146,
    `Role_8` as unimelb_training_Role_8_original_147,
    `Role_9` as unimelb_training_Role_9_original_148,
    `SEO_Code_1` as unimelb_training_SEO_Code_1_original_149,
    `SEO_Code_2` as unimelb_training_SEO_Code_2_original_150,
    `SEO_Code_3` as unimelb_training_SEO_Code_3_original_151,
    `SEO_Code_4` as unimelb_training_SEO_Code_4_original_152,
    `SEO_Code_5` as unimelb_training_SEO_Code_5_original_153,
    `SEO_Percentage_1` as unimelb_training_SEO_Percentage_1_original_154,
    `SEO_Percentage_2` as unimelb_training_SEO_Percentage_2_original_155,
    `SEO_Percentage_3` as unimelb_training_SEO_Percentage_3_original_156,
    `SEO_Percentage_4` as unimelb_training_SEO_Percentage_4_original_157,
    `SEO_Percentage_5` as unimelb_training_SEO_Percentage_5_original_158,
    `Sponsor_Code` as unimelb_training_Sponsor_Code_original_159,
    `With_PHD_1` as unimelb_training_With_PHD_1_original_160,
    `With_PHD_10` as unimelb_training_With_PHD_10_original_161,
    `With_PHD_11` as unimelb_training_With_PHD_11_original_162,
    `With_PHD_2` as unimelb_training_With_PHD_2_original_163,
    `With_PHD_3` as unimelb_training_With_PHD_3_original_164,
    `With_PHD_4` as unimelb_training_With_PHD_4_original_165,
    `With_PHD_5` as unimelb_training_With_PHD_5_original_166,
    `With_PHD_6` as unimelb_training_With_PHD_6_original_167,
    `With_PHD_7` as unimelb_training_With_PHD_7_original_168,
    `With_PHD_8` as unimelb_training_With_PHD_8_original_169,
    `With_PHD_9` as unimelb_training_With_PHD_9_original_170,
    `Year_of_Birth_1` as unimelb_training_Year_of_Birth_1_original_171,
    `Year_of_Birth_2` as unimelb_training_Year_of_Birth_2_original_172,
    `Year_of_Birth_3` as unimelb_training_Year_of_Birth_3_original_173,
    `Year_of_Birth_4` as unimelb_training_Year_of_Birth_4_original_174,
    `Year_of_Birth_5` as unimelb_training_Year_of_Birth_5_original_175,
    `Year_of_Birth_6` as unimelb_training_Year_of_Birth_6_original_176,
    `Year_of_Birth_7` as unimelb_training_Year_of_Birth_7_original_177,
    `Year_of_Birth_8` as unimelb_training_Year_of_Birth_8_original_178,
    `Year_of_Birth_9` as unimelb_training_Year_of_Birth_9_original_179,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_combine_180,
    `Country_of_Birth_1` as unimelb_training_Country_of_Birth_1_combine_180,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_A_1_Start_date_0s_32d_100 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_A_1_Start_date_0s_32d_100 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_181,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_A__1_Start_date_0s_32d_100 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_A__1_Start_date_0s_32d_100 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_182,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_Dept_No__1_Start_date_0s_32d_200 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_Dept_No__1_Start_date_0s_32d_200 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_183,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_Year_of_Birth_1_Start_date_0s_32d_200 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_Year_of_Birth_1_Start_date_0s_32d_200 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_184,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_B_1_Start_date_0s_32d_200 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_B_1_Start_date_0s_32d_200 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_185,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_C_1_Start_date_0s_32d_100 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_C_1_Start_date_0s_32d_100 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_186,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_With_PHD_1_Start_date_0s_32d_100 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_With_PHD_1_Start_date_0s_32d_100 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_187,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_1_Start_date_0s_32d_200 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_1_Start_date_0s_32d_200 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_188,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_combine_189,
    `Faculty_No__1` as unimelb_training_Faculty_No__1_combine_189,
    `Contract_Value_Band___see_note_A` as unimelb_training_Contract_Value_Band___see_note_A_combine_190,
    `Grant_Category_Code` as unimelb_training_Grant_Category_Code_combine_190,
    distinct_count(`Country_of_Birth_1`) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_7d_200 as unimelb_training_Country_of_Birth_1_window_unique_count_191,
    distinct_count(`Contract_Value_Band___see_note_A`) over unimelb_training_B_1_Start_date_0s_2d_200 as unimelb_training_Contract_Value_Band___see_note_A_window_unique_count_192,
    distinct_count(`Contract_Value_Band___see_note_A`) over unimelb_training_Grant_Category_Code_Start_date_0s_64d_100 as unimelb_training_Contract_Value_Band___see_note_A_window_unique_count_193,
    case when !isnull(at(`Number_of_Unsuccessful_Grant_1`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_2d_100 then count_where(`Number_of_Unsuccessful_Grant_1`, `Number_of_Unsuccessful_Grant_1` = at(`Number_of_Unsuccessful_Grant_1`, 0)) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_2d_100 else null end as unimelb_training_Number_of_Unsuccessful_Grant_1_window_count_194,
    distinct_count(`Year_of_Birth_1`) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_7d_200 as unimelb_training_Year_of_Birth_1_window_unique_count_195,
    distinct_count(`Year_of_Birth_1`) over unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 as unimelb_training_Year_of_Birth_1_window_unique_count_196,
    case when !isnull(at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_RFCD_Code_4_Start_date_0s_32d_100 then count_where(`Contract_Value_Band___see_note_A`, `Contract_Value_Band___see_note_A` = at(`Contract_Value_Band___see_note_A`, 0)) over unimelb_training_RFCD_Code_4_Start_date_0s_32d_100 else null end as unimelb_training_Contract_Value_Band___see_note_A_window_count_197
from
    `unimelb_training`
    window unimelb_training_A_1_Start_date_0s_32d_100 as (partition by `A_1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_A__1_Start_date_0s_32d_100 as (partition by `A__1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Dept_No__1_Start_date_0s_32d_200 as (partition by `Dept_No__1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_Year_of_Birth_1_Start_date_0s_32d_200 as (partition by `Year_of_Birth_1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_B_1_Start_date_0s_32d_200 as (partition by `B_1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_C_1_Start_date_0s_32d_100 as (partition by `C_1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_With_PHD_1_Start_date_0s_32d_100 as (partition by `With_PHD_1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_No__of_Years_in_Uni_at_Time_of_Grant_1_Start_date_0s_32d_200 as (partition by `No__of_Years_in_Uni_at_Time_of_Grant_1` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_7d_200 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 7d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_B_1_Start_date_0s_2d_200 as (partition by `B_1` order by `Start_date` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    unimelb_training_Grant_Category_Code_Start_date_0s_64d_100 as (partition by `Grant_Category_Code` order by `Start_date` rows_range between 64d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_2d_100 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 2d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_Contract_Value_Band___see_note_A_Start_date_0s_14d_100 as (partition by `Contract_Value_Band___see_note_A` order by `Start_date` rows_range between 14d open preceding and 0s preceding MAXSIZE 100),
    unimelb_training_RFCD_Code_4_Start_date_0s_32d_100 as (partition by `RFCD_Code_4` order by `Start_date` rows_range between 32d open preceding and 0s preceding MAXSIZE 100);