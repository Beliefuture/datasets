# start sql code
# output table name: sql_table

select
    `id` as id_1,
    `year` as kbopitchingdata_year_original_0,
    `id` as kbopitchingdata_id_original_1,
    `win_loss_percentage` as kbopitchingdata_win_loss_percentage_original_2,
    `ERA` as kbopitchingdata_ERA_original_3,
    `WHIP` as kbopitchingdata_WHIP_original_4,
    `average_age` as kbopitchingdata_average_age_original_5,
    `balks` as kbopitchingdata_balks_original_6,
    `batters_faced` as kbopitchingdata_batters_faced_original_7,
    `complete_game` as kbopitchingdata_complete_game_original_8,
    `earned_runs` as kbopitchingdata_earned_runs_original_9,
    `games` as kbopitchingdata_games_original_10,
    `games_finished` as kbopitchingdata_games_finished_original_11,
    `games_started` as kbopitchingdata_games_started_original_12,
    `hit_batter` as kbopitchingdata_hit_batter_original_13,
    `hits` as kbopitchingdata_hits_original_14,
    `hits_9` as kbopitchingdata_hits_9_original_15,
    `home_runs` as kbopitchingdata_home_runs_original_16,
    `homeruns_9` as kbopitchingdata_homeruns_9_original_17,
    `innings_pitched` as kbopitchingdata_innings_pitched_original_18,
    `intentional_walks` as kbopitchingdata_intentional_walks_original_19,
    `losses` as kbopitchingdata_losses_original_20,
    `run_average_9` as kbopitchingdata_run_average_9_original_21,
    `runs` as kbopitchingdata_runs_original_22,
    `runs_per_game` as kbopitchingdata_runs_per_game_original_23,
    `saves` as kbopitchingdata_saves_original_24,
    `shutouts` as kbopitchingdata_shutouts_original_25,
    `strikeout_walk` as kbopitchingdata_strikeout_walk_original_26,
    `strikeouts` as kbopitchingdata_strikeouts_original_27,
    `strikeouts_9` as kbopitchingdata_strikeouts_9_original_28,
    `team` as kbopitchingdata_team_original_29,
    `walks` as kbopitchingdata_walks_original_30,
    `walks_9` as kbopitchingdata_walks_9_original_31,
    `wild_pitches` as kbopitchingdata_wild_pitches_original_32,
    `wins` as kbopitchingdata_wins_original_33,
    `intentional_walks` as kbopitchingdata_intentional_walks_combine_34,
    `wild_pitches` as kbopitchingdata_wild_pitches_combine_34,
    `team` as kbopitchingdata_team_combine_34,
    `balks` as kbopitchingdata_balks_combine_35,
    `games_started` as kbopitchingdata_games_started_combine_35,
    `games_finished` as kbopitchingdata_games_finished_combine_36,
    `wild_pitches` as kbopitchingdata_wild_pitches_combine_36,
    `complete_game` as kbopitchingdata_complete_game_combine_36,
    `intentional_walks` as kbopitchingdata_intentional_walks_combine_37,
    `games_finished` as kbopitchingdata_games_finished_combine_37,
    `team` as kbopitchingdata_team_combine_37,
    `games_finished` as kbopitchingdata_games_finished_combine_38,
    `wild_pitches` as kbopitchingdata_wild_pitches_combine_38,
    `team` as kbopitchingdata_team_combine_38,
    fz_top1_ratio(`shutouts`) over kbopitchingdata_games_finished_year_0s_1h_100 as kbopitchingdata_shutouts_window_top1_ratio_39,
    `intentional_walks` as kbopitchingdata_intentional_walks_combine_40,
    `games_finished` as kbopitchingdata_games_finished_combine_40,
    `complete_game` as kbopitchingdata_complete_game_combine_40,
    fz_top1_ratio(`shutouts`) over kbopitchingdata_wild_pitches_year_0s_1h_100 as kbopitchingdata_shutouts_window_top1_ratio_41,
    `wild_pitches` as kbopitchingdata_wild_pitches_combine_42,
    `complete_game` as kbopitchingdata_complete_game_combine_42,
    `games` as kbopitchingdata_games_combine_42,
    avg(`strikeouts_9`) over kbopitchingdata_losses_year_0s_1h_100 as kbopitchingdata_strikeouts_9_window_avg_43,
    sum(`strikeouts_9`) over kbopitchingdata_home_runs_year_0s_1h_100 as kbopitchingdata_strikeouts_9_window_sum_44,
    `intentional_walks` as kbopitchingdata_intentional_walks_combine_45,
    `balks` as kbopitchingdata_balks_combine_45,
    `games` as kbopitchingdata_games_combine_45,
    avg(`strikeouts_9`) over kbopitchingdata_wins_year_0s_1h_100 as kbopitchingdata_strikeouts_9_window_avg_46,
    `balks` as kbopitchingdata_balks_combine_47,
    `games_started` as kbopitchingdata_games_started_combine_47,
    `shutouts` as kbopitchingdata_shutouts_combine_47,
    `balks` as kbopitchingdata_balks_combine_48,
    `shutouts` as kbopitchingdata_shutouts_combine_48,
    `games` as kbopitchingdata_games_combine_48,
    `games_started` as kbopitchingdata_games_started_combine_49,
    `complete_game` as kbopitchingdata_complete_game_combine_49,
    sum(`strikeouts_9`) over kbopitchingdata_losses_year_0s_1h_100 as kbopitchingdata_strikeouts_9_window_sum_50,
    min(`strikeouts_9`) over kbopitchingdata_wins_year_0s_1h_100 as kbopitchingdata_strikeouts_9_window_min_51
from
    `kbopitchingdata`
    window kbopitchingdata_games_finished_year_0s_1h_100 as (partition by `games_finished` order by `year` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    kbopitchingdata_wild_pitches_year_0s_1h_100 as (partition by `wild_pitches` order by `year` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    kbopitchingdata_losses_year_0s_1h_100 as (partition by `losses` order by `year` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    kbopitchingdata_home_runs_year_0s_1h_100 as (partition by `home_runs` order by `year` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    kbopitchingdata_wins_year_0s_1h_100 as (partition by `wins` order by `year` rows_range between 1h open preceding and 0s preceding MAXSIZE 100);