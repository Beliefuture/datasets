# start sql code
# output table name: sql_table

select
    `id` as id_1,
    `pickup_datetime` as train_pickup_datetime_original_0,
    `id` as train_id_original_1,
    `trip_duration` as train_trip_duration_original_2,
    `dropoff_datetime` as train_dropoff_datetime_original_3,
    `dropoff_latitude` as train_dropoff_latitude_original_4,
    `dropoff_longitude` as train_dropoff_longitude_original_5,
    `passenger_count` as train_passenger_count_original_6,
    `pickup_latitude` as train_pickup_latitude_original_7,
    `pickup_longitude` as train_pickup_longitude_original_8,
    `store_and_fwd_flag` as train_store_and_fwd_flag_original_9,
    `vendor_id` as train_vendor_id_original_10,
    `dropoff_longitude` as train_dropoff_longitude_divide_11,
    `pickup_longitude` as train_pickup_longitude_divide_11,
    `pickup_longitude` as train_pickup_longitude_divide_12,
    `dropoff_longitude` as train_dropoff_longitude_divide_12,
    `pickup_latitude` as train_pickup_latitude_divide_13,
    `dropoff_latitude` as train_dropoff_latitude_divide_13,
    `dropoff_latitude` as train_dropoff_latitude_divide_14,
    `pickup_latitude` as train_pickup_latitude_divide_14,
    `pickup_longitude` as train_pickup_longitude_multiply_15,
    `dropoff_latitude` as train_dropoff_latitude_multiply_15,
    `dropoff_longitude` as train_dropoff_longitude_multiply_15,
    `pickup_longitude` as train_pickup_longitude_multiply_16,
    `dropoff_latitude` as train_dropoff_latitude_multiply_16,
    `pickup_longitude` as train_pickup_longitude_multiply_17,
    `pickup_latitude` as train_pickup_latitude_multiply_17,
    `dropoff_longitude` as train_dropoff_longitude_multiply_17,
    `pickup_longitude` as train_pickup_longitude_multiply_18,
    `dropoff_longitude` as train_dropoff_longitude_multiply_18,
    `pickup_latitude` as train_pickup_latitude_multiply_19,
    `dropoff_longitude` as train_dropoff_longitude_multiply_19,
    hour(timestamp(`dropoff_datetime`)) as train_dropoff_datetime_hourofday_20,
    hour(timestamp(`pickup_datetime`)) as train_pickup_datetime_hourofday_21,
    case when !isnull(at(`vendor_id`, 0)) over train_store_and_fwd_flag_pickup_datetime_0s_1h_-1 then count_where(`vendor_id`, `vendor_id` = at(`vendor_id`, 0)) over train_store_and_fwd_flag_pickup_datetime_0s_1h_-1 else null end as train_vendor_id_window_count_22,
    sum(`pickup_latitude`) over train_vendor_id_pickup_datetime_0s_1h_-1 as train_pickup_latitude_window_sum_23,
    sum(`pickup_latitude`) over train_store_and_fwd_flag_pickup_datetime_0s_1h_-2 as train_pickup_latitude_window_sum_24,
    case when !isnull(at(`vendor_id`, 0)) over train_store_and_fwd_flag_pickup_datetime_0s_2h_-1 then count_where(`vendor_id`, `vendor_id` = at(`vendor_id`, 0)) over train_store_and_fwd_flag_pickup_datetime_0s_2h_-1 else null end as train_vendor_id_window_count_25,
    avg(`pickup_latitude`) over train_store_and_fwd_flag_pickup_datetime_0s_5h_-1 as train_pickup_latitude_window_avg_26,
    sum(`pickup_latitude`) over train_vendor_id_pickup_datetime_0s_2h_-2 as train_pickup_latitude_window_sum_27,
    sum(`dropoff_latitude`) over train_store_and_fwd_flag_pickup_datetime_0s_1h_-2 as train_dropoff_latitude_window_sum_28
from
    `train`
    window train_store_and_fwd_flag_pickup_datetime_0s_1h_-1 as (partition by `store_and_fwd_flag` order by `pickup_datetime` rows_range between 1h open preceding and 0s preceding),
    train_vendor_id_pickup_datetime_0s_1h_-1 as (partition by `vendor_id` order by `pickup_datetime` rows_range between 1h open preceding and 0s preceding),
    train_store_and_fwd_flag_pickup_datetime_0s_1h_-2 as (partition by `store_and_fwd_flag` order by `pickup_datetime` rows_range between 1h open preceding and 0s preceding),
    train_store_and_fwd_flag_pickup_datetime_0s_2h_-1 as (partition by `store_and_fwd_flag` order by `pickup_datetime` rows_range between 2h open preceding and 0s preceding),
    train_store_and_fwd_flag_pickup_datetime_0s_5h_-1 as (partition by `store_and_fwd_flag` order by `pickup_datetime` rows_range between 5h open preceding and 0s preceding),
    train_vendor_id_pickup_datetime_0s_2h_-2 as (partition by `vendor_id` order by `pickup_datetime` rows_range between 2h open preceding and 0s preceding);