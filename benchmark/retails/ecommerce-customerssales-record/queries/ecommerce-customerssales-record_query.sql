# start sql code
# output table name: sql_table

select
    `index` as index_1,
    `FIRST_ORDER_DATE` as Sales_FIRST_ORDER_DATE_original_0,
    `index` as Sales_index_original_1,
    `REVENUE` as Sales_REVENUE_original_2,
    `AVERAGESHIPPING` as Sales_AVERAGESHIPPING_original_3,
    `AVERAGE_ORDER_VALUE` as Sales_AVERAGE_ORDER_VALUE_original_4,
    `AVGDAYSBETWEENORDERS` as Sales_AVGDAYSBETWEENORDERS_original_5,
    `CARRIAGE_REVENUE` as Sales_CARRIAGE_REVENUE_original_6,
    `DAYSSINCELASTORDER` as Sales_DAYSSINCELASTORDER_original_7,
    `FRIDAY_ORDERS` as Sales_FRIDAY_ORDERS_original_8,
    `FRIDAY_REVENUE` as Sales_FRIDAY_REVENUE_original_9,
    `LATEST_ORDER_DATE` as Sales_LATEST_ORDER_DATE_original_10,
    `MONDAY_ORDERS` as Sales_MONDAY_ORDERS_original_11,
    `MONDAY_REVENUE` as Sales_MONDAY_REVENUE_original_12,
    `SATURDAY_ORDERS` as Sales_SATURDAY_ORDERS_original_13,
    `SATURDAY_REVENUE` as Sales_SATURDAY_REVENUE_original_14,
    `SUNDAY_ORDERS` as Sales_SUNDAY_ORDERS_original_15,
    `SUNDAY_REVENUE` as Sales_SUNDAY_REVENUE_original_16,
    `THURSDAY_ORDERS` as Sales_THURSDAY_ORDERS_original_17,
    `THURSDAY_REVENUE` as Sales_THURSDAY_REVENUE_original_18,
    `TIME_0000_0600_ORDERS` as Sales_TIME_0000_0600_ORDERS_original_19,
    `TIME_0000_0600_REVENUE` as Sales_TIME_0000_0600_REVENUE_original_20,
    `TIME_0601_1200_ORDERS` as Sales_TIME_0601_1200_ORDERS_original_21,
    `TIME_0601_1200_REVENUE` as Sales_TIME_0601_1200_REVENUE_original_22,
    `TIME_1200_1800_ORDERS` as Sales_TIME_1200_1800_ORDERS_original_23,
    `TIME_1200_1800_REVENUE` as Sales_TIME_1200_1800_REVENUE_original_24,
    `TIME_1801_2359_ORDERS` as Sales_TIME_1801_2359_ORDERS_original_25,
    `TIME_1801_2359_REVENUE` as Sales_TIME_1801_2359_REVENUE_original_26,
    `TOTAL_ORDERS` as Sales_TOTAL_ORDERS_original_27,
    `TUESDAY_ORDERS` as Sales_TUESDAY_ORDERS_original_28,
    `TUESDAY_REVENUE` as Sales_TUESDAY_REVENUE_original_29,
    `WEDNESDAY_ORDERS` as Sales_WEDNESDAY_ORDERS_original_30,
    `WEDNESDAY_REVENUE` as Sales_WEDNESDAY_REVENUE_original_31,
    `WEEK1_DAY01_DAY07_ORDERS` as Sales_WEEK1_DAY01_DAY07_ORDERS_original_32,
    `WEEK1_DAY01_DAY07_REVENUE` as Sales_WEEK1_DAY01_DAY07_REVENUE_original_33,
    `WEEK2_DAY08_DAY15_ORDERS` as Sales_WEEK2_DAY08_DAY15_ORDERS_original_34,
    `WEEK2_DAY08_DAY15_REVENUE` as Sales_WEEK2_DAY08_DAY15_REVENUE_original_35,
    `WEEK3_DAY16_DAY23_ORDERS` as Sales_WEEK3_DAY16_DAY23_ORDERS_original_36,
    `WEEK3_DAY16_DAY23_REVENUE` as Sales_WEEK3_DAY16_DAY23_REVENUE_original_37,
    `WEEK4_DAY24_DAY31_ORDERS` as Sales_WEEK4_DAY24_DAY31_ORDERS_original_38,
    `WEEK4_DAY24_DAY31_REVENUE` as Sales_WEEK4_DAY24_DAY31_REVENUE_original_39,
    case when !isnull(at(`TIME_0601_1200_ORDERS`, 0)) over Sales_SUNDAY_ORDERS_FIRST_ORDER_DATE_0s_2d_200 then count_where(`TIME_0601_1200_ORDERS`, `TIME_0601_1200_ORDERS` = at(`TIME_0601_1200_ORDERS`, 0)) over Sales_SUNDAY_ORDERS_FIRST_ORDER_DATE_0s_2d_200 else null end as Sales_TIME_0601_1200_ORDERS_window_count_40,
    case when !isnull(at(`SUNDAY_ORDERS`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_200 then count_where(`SUNDAY_ORDERS`, `SUNDAY_ORDERS` = at(`SUNDAY_ORDERS`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_200 else null end as Sales_SUNDAY_ORDERS_window_count_41,
    case when !isnull(at(`TIME_0601_1200_ORDERS`, 0)) over Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_2d_200 then count_where(`TIME_0601_1200_ORDERS`, `TIME_0601_1200_ORDERS` = at(`TIME_0601_1200_ORDERS`, 0)) over Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_2d_200 else null end as Sales_TIME_0601_1200_ORDERS_window_count_42,
    case when !isnull(at(`DAYSSINCELASTORDER`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_200 then count_where(`DAYSSINCELASTORDER`, `DAYSSINCELASTORDER` = at(`DAYSSINCELASTORDER`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_200 else null end as Sales_DAYSSINCELASTORDER_window_count_43,
    case when !isnull(at(`WEEK1_DAY01_DAY07_ORDERS`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_100 then count_where(`WEEK1_DAY01_DAY07_ORDERS`, `WEEK1_DAY01_DAY07_ORDERS` = at(`WEEK1_DAY01_DAY07_ORDERS`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_100 else null end as Sales_WEEK1_DAY01_DAY07_ORDERS_window_count_44,
    case when !isnull(at(`TIME_0601_1200_ORDERS`, 0)) over Sales_WEEK1_DAY01_DAY07_ORDERS_FIRST_ORDER_DATE_0s_2d_100 then count_where(`TIME_0601_1200_ORDERS`, `TIME_0601_1200_ORDERS` = at(`TIME_0601_1200_ORDERS`, 0)) over Sales_WEEK1_DAY01_DAY07_ORDERS_FIRST_ORDER_DATE_0s_2d_100 else null end as Sales_TIME_0601_1200_ORDERS_window_count_45,
    case when !isnull(at(`WEEK4_DAY24_DAY31_ORDERS`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_100 then count_where(`WEEK4_DAY24_DAY31_ORDERS`, `WEEK4_DAY24_DAY31_ORDERS` = at(`WEEK4_DAY24_DAY31_ORDERS`, 0)) over Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_100 else null end as Sales_WEEK4_DAY24_DAY31_ORDERS_window_count_46,
    case when !isnull(at(`TIME_0601_1200_ORDERS`, 0)) over Sales_THURSDAY_ORDERS_FIRST_ORDER_DATE_0s_2d_200 then count_where(`TIME_0601_1200_ORDERS`, `TIME_0601_1200_ORDERS` = at(`TIME_0601_1200_ORDERS`, 0)) over Sales_THURSDAY_ORDERS_FIRST_ORDER_DATE_0s_2d_200 else null end as Sales_TIME_0601_1200_ORDERS_window_count_47,
    case when !isnull(at(`TIME_0601_1200_ORDERS`, 0)) over Sales_WEEK4_DAY24_DAY31_ORDERS_FIRST_ORDER_DATE_0s_2d_100 then count_where(`TIME_0601_1200_ORDERS`, `TIME_0601_1200_ORDERS` = at(`TIME_0601_1200_ORDERS`, 0)) over Sales_WEEK4_DAY24_DAY31_ORDERS_FIRST_ORDER_DATE_0s_2d_100 else null end as Sales_TIME_0601_1200_ORDERS_window_count_48,
    distinct_count(`TUESDAY_ORDERS`) over Sales_WEEK2_DAY08_DAY15_ORDERS_FIRST_ORDER_DATE_0s_2d_100 as Sales_TUESDAY_ORDERS_window_unique_count_49,
    avg(`MONDAY_REVENUE`) over Sales_TIME_1801_2359_ORDERS_FIRST_ORDER_DATE_0s_32d_200 as Sales_MONDAY_REVENUE_window_avg_50,
    avg(`FRIDAY_REVENUE`) over Sales_TIME_1801_2359_ORDERS_FIRST_ORDER_DATE_0s_32d_100 as Sales_FRIDAY_REVENUE_window_avg_51,
    distinct_count(`SATURDAY_ORDERS`) over Sales_WEEK1_DAY01_DAY07_ORDERS_FIRST_ORDER_DATE_0s_2d_200 as Sales_SATURDAY_ORDERS_window_unique_count_52,
    avg(`AVERAGESHIPPING`) over Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_32d_100 as Sales_AVERAGESHIPPING_window_avg_53,
    avg(`WEDNESDAY_REVENUE`) over Sales_TIME_1801_2359_ORDERS_FIRST_ORDER_DATE_0s_32d_200 as Sales_WEDNESDAY_REVENUE_window_avg_54,
    avg(`WEEK4_DAY24_DAY31_REVENUE`) over Sales_TIME_1200_1800_ORDERS_FIRST_ORDER_DATE_0s_32d_200 as Sales_WEEK4_DAY24_DAY31_REVENUE_window_avg_55,
    avg(`CARRIAGE_REVENUE`) over Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_32d_200 as Sales_CARRIAGE_REVENUE_window_avg_56,
    avg(`AVERAGE_ORDER_VALUE`) over Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_32d_100 as Sales_AVERAGE_ORDER_VALUE_window_avg_57
from
    `Sales`
    window Sales_SUNDAY_ORDERS_FIRST_ORDER_DATE_0s_2d_200 as (partition by `SUNDAY_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_200 as (partition by `TIME_0601_1200_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_2d_200 as (partition by `DAYSSINCELASTORDER` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    Sales_TIME_0601_1200_ORDERS_FIRST_ORDER_DATE_0s_2d_100 as (partition by `TIME_0601_1200_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 100),
    Sales_WEEK1_DAY01_DAY07_ORDERS_FIRST_ORDER_DATE_0s_2d_100 as (partition by `WEEK1_DAY01_DAY07_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 100),
    Sales_THURSDAY_ORDERS_FIRST_ORDER_DATE_0s_2d_200 as (partition by `THURSDAY_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    Sales_WEEK4_DAY24_DAY31_ORDERS_FIRST_ORDER_DATE_0s_2d_100 as (partition by `WEEK4_DAY24_DAY31_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 100),
    Sales_WEEK2_DAY08_DAY15_ORDERS_FIRST_ORDER_DATE_0s_2d_100 as (partition by `WEEK2_DAY08_DAY15_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 100),
    Sales_TIME_1801_2359_ORDERS_FIRST_ORDER_DATE_0s_32d_200 as (partition by `TIME_1801_2359_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 32d open preceding and 0s preceding MAXSIZE 200),
    Sales_TIME_1801_2359_ORDERS_FIRST_ORDER_DATE_0s_32d_100 as (partition by `TIME_1801_2359_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 32d open preceding and 0s preceding MAXSIZE 100),
    Sales_WEEK1_DAY01_DAY07_ORDERS_FIRST_ORDER_DATE_0s_2d_200 as (partition by `WEEK1_DAY01_DAY07_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 2d open preceding and 0s preceding MAXSIZE 200),
    Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_32d_100 as (partition by `DAYSSINCELASTORDER` order by `FIRST_ORDER_DATE` rows_range between 32d open preceding and 0s preceding MAXSIZE 100),
    Sales_TIME_1200_1800_ORDERS_FIRST_ORDER_DATE_0s_32d_200 as (partition by `TIME_1200_1800_ORDERS` order by `FIRST_ORDER_DATE` rows_range between 32d open preceding and 0s preceding MAXSIZE 200),
    Sales_DAYSSINCELASTORDER_FIRST_ORDER_DATE_0s_32d_200 as (partition by `DAYSSINCELASTORDER` order by `FIRST_ORDER_DATE` rows_range between 32d open preceding and 0s preceding MAXSIZE 200);