# start sql code
# output table name: sql_table

select
    `id` as id_1,
    `timestamp` as train_timestamp_original_0,
    `id` as train_id_original_1,
    `price_doc` as train_price_doc_original_2,
    `0_13_all` as train_0_13_all_original_3,
    `0_13_male` as train_0_13_male_original_4,
    `0_17_all` as train_0_17_all_original_5,
    `0_6_female` as train_0_6_female_original_6,
    `0_6_male` as train_0_6_male_original_7,
    `16_29_all` as train_16_29_all_original_8,
    `16_29_male` as train_16_29_male_original_9,
    `7_14_female` as train_7_14_female_original_10,
    `7_14_male` as train_7_14_male_original_11,
    `ID_big_road1` as train_ID_big_road1_original_12,
    `ID_big_road2` as train_ID_big_road2_original_13,
    `ID_bus_terminal` as train_ID_bus_terminal_original_14,
    `ID_metro` as train_ID_metro_original_15,
    `ID_railroad_station_avto` as train_ID_railroad_station_avto_original_16,
    `ID_railroad_station_walk` as train_ID_railroad_station_walk_original_17,
    `ID_railroad_terminal` as train_ID_railroad_terminal_original_18,
    `additional_education_km` as train_additional_education_km_original_19,
    `additional_education_raion` as train_additional_education_raion_original_20,
    `area_m` as train_area_m_original_21,
    `basketball_km` as train_basketball_km_original_22,
    `big_church_count_1000` as train_big_church_count_1000_original_23,
    `big_church_count_1500` as train_big_church_count_1500_original_24,
    `big_church_count_2000` as train_big_church_count_2000_original_25,
    `big_church_count_3000` as train_big_church_count_3000_original_26,
    `big_church_count_500` as train_big_church_count_500_original_27,
    `big_church_count_5000` as train_big_church_count_5000_original_28,
    `big_church_km` as train_big_church_km_original_29,
    `big_market_km` as train_big_market_km_original_30,
    `big_market_raion` as train_big_market_raion_original_31,
    `big_road1_1line` as train_big_road1_1line_original_32,
    `big_road1_km` as train_big_road1_km_original_33,
    `big_road2_km` as train_big_road2_km_original_34,
    `build_count_1921-1945` as train_build_count_1921-1945_original_35,
    `build_count_1946-1970` as train_build_count_1946-1970_original_36,
    `build_count_1971-1995` as train_build_count_1971-1995_original_37,
    `build_count_after_1995` as train_build_count_after_1995_original_38,
    `build_count_before_1920` as train_build_count_before_1920_original_39,
    `build_count_block` as train_build_count_block_original_40,
    `build_count_brick` as train_build_count_brick_original_41,
    `build_count_foam` as train_build_count_foam_original_42,
    `build_count_frame` as train_build_count_frame_original_43,
    `build_count_mix` as train_build_count_mix_original_44,
    `build_count_monolith` as train_build_count_monolith_original_45,
    `build_count_panel` as train_build_count_panel_original_46,
    `build_count_slag` as train_build_count_slag_original_47,
    `build_count_wood` as train_build_count_wood_original_48,
    `build_year` as train_build_year_original_49,
    `bulvar_ring_km` as train_bulvar_ring_km_original_50,
    `bus_terminal_avto_km` as train_bus_terminal_avto_km_original_51,
    `cafe_avg_price_1000` as train_cafe_avg_price_1000_original_52,
    `cafe_avg_price_1500` as train_cafe_avg_price_1500_original_53,
    `cafe_avg_price_2000` as train_cafe_avg_price_2000_original_54,
    `cafe_avg_price_3000` as train_cafe_avg_price_3000_original_55,
    `cafe_avg_price_500` as train_cafe_avg_price_500_original_56,
    `cafe_avg_price_5000` as train_cafe_avg_price_5000_original_57,
    `cafe_count_1000` as train_cafe_count_1000_original_58,
    `cafe_count_1000_na_price` as train_cafe_count_1000_na_price_original_59,
    `cafe_count_1000_price_1000` as train_cafe_count_1000_price_1000_original_60,
    `cafe_count_1000_price_1500` as train_cafe_count_1000_price_1500_original_61,
    `cafe_count_1000_price_2500` as train_cafe_count_1000_price_2500_original_62,
    `cafe_count_1000_price_4000` as train_cafe_count_1000_price_4000_original_63,
    `cafe_count_1000_price_500` as train_cafe_count_1000_price_500_original_64,
    `cafe_count_1000_price_high` as train_cafe_count_1000_price_high_original_65,
    `cafe_count_1500` as train_cafe_count_1500_original_66,
    `cafe_count_1500_na_price` as train_cafe_count_1500_na_price_original_67,
    `cafe_count_1500_price_1000` as train_cafe_count_1500_price_1000_original_68,
    `cafe_count_1500_price_1500` as train_cafe_count_1500_price_1500_original_69,
    `cafe_count_1500_price_2500` as train_cafe_count_1500_price_2500_original_70,
    `cafe_count_1500_price_4000` as train_cafe_count_1500_price_4000_original_71,
    `cafe_count_1500_price_500` as train_cafe_count_1500_price_500_original_72,
    `cafe_count_1500_price_high` as train_cafe_count_1500_price_high_original_73,
    `cafe_count_2000` as train_cafe_count_2000_original_74,
    `cafe_count_2000_na_price` as train_cafe_count_2000_na_price_original_75,
    `cafe_count_2000_price_1000` as train_cafe_count_2000_price_1000_original_76,
    `cafe_count_2000_price_1500` as train_cafe_count_2000_price_1500_original_77,
    `cafe_count_2000_price_2500` as train_cafe_count_2000_price_2500_original_78,
    `cafe_count_2000_price_4000` as train_cafe_count_2000_price_4000_original_79,
    `cafe_count_2000_price_500` as train_cafe_count_2000_price_500_original_80,
    `cafe_count_2000_price_high` as train_cafe_count_2000_price_high_original_81,
    `cafe_count_3000` as train_cafe_count_3000_original_82,
    `cafe_count_3000_na_price` as train_cafe_count_3000_na_price_original_83,
    `cafe_count_3000_price_1000` as train_cafe_count_3000_price_1000_original_84,
    `cafe_count_3000_price_1500` as train_cafe_count_3000_price_1500_original_85,
    `cafe_count_3000_price_2500` as train_cafe_count_3000_price_2500_original_86,
    `cafe_count_3000_price_4000` as train_cafe_count_3000_price_4000_original_87,
    `cafe_count_3000_price_500` as train_cafe_count_3000_price_500_original_88,
    `cafe_count_3000_price_high` as train_cafe_count_3000_price_high_original_89,
    `cafe_count_500` as train_cafe_count_500_original_90,
    `cafe_count_5000` as train_cafe_count_5000_original_91,
    `cafe_count_5000_na_price` as train_cafe_count_5000_na_price_original_92,
    `cafe_count_5000_price_1000` as train_cafe_count_5000_price_1000_original_93,
    `cafe_count_5000_price_1500` as train_cafe_count_5000_price_1500_original_94,
    `cafe_count_5000_price_2500` as train_cafe_count_5000_price_2500_original_95,
    `cafe_count_5000_price_4000` as train_cafe_count_5000_price_4000_original_96,
    `cafe_count_5000_price_500` as train_cafe_count_5000_price_500_original_97,
    `cafe_count_5000_price_high` as train_cafe_count_5000_price_high_original_98,
    `cafe_count_500_na_price` as train_cafe_count_500_na_price_original_99,
    `cafe_count_500_price_1000` as train_cafe_count_500_price_1000_original_100,
    `cafe_count_500_price_1500` as train_cafe_count_500_price_1500_original_101,
    `cafe_count_500_price_2500` as train_cafe_count_500_price_2500_original_102,
    `cafe_count_500_price_4000` as train_cafe_count_500_price_4000_original_103,
    `cafe_count_500_price_500` as train_cafe_count_500_price_500_original_104,
    `cafe_count_500_price_high` as train_cafe_count_500_price_high_original_105,
    `cafe_sum_1000_max_price_avg` as train_cafe_sum_1000_max_price_avg_original_106,
    `cafe_sum_1000_min_price_avg` as train_cafe_sum_1000_min_price_avg_original_107,
    `cafe_sum_1500_max_price_avg` as train_cafe_sum_1500_max_price_avg_original_108,
    `cafe_sum_1500_min_price_avg` as train_cafe_sum_1500_min_price_avg_original_109,
    `cafe_sum_2000_max_price_avg` as train_cafe_sum_2000_max_price_avg_original_110,
    `cafe_sum_2000_min_price_avg` as train_cafe_sum_2000_min_price_avg_original_111,
    `cafe_sum_3000_max_price_avg` as train_cafe_sum_3000_max_price_avg_original_112,
    `cafe_sum_3000_min_price_avg` as train_cafe_sum_3000_min_price_avg_original_113,
    `cafe_sum_5000_max_price_avg` as train_cafe_sum_5000_max_price_avg_original_114,
    `cafe_sum_5000_min_price_avg` as train_cafe_sum_5000_min_price_avg_original_115,
    `cafe_sum_500_max_price_avg` as train_cafe_sum_500_max_price_avg_original_116,
    `cafe_sum_500_min_price_avg` as train_cafe_sum_500_min_price_avg_original_117,
    `catering_km` as train_catering_km_original_118,
    `cemetery_km` as train_cemetery_km_original_119,
    `church_count_1000` as train_church_count_1000_original_120,
    `church_count_1500` as train_church_count_1500_original_121,
    `church_count_2000` as train_church_count_2000_original_122,
    `church_count_3000` as train_church_count_3000_original_123,
    `church_count_500` as train_church_count_500_original_124,
    `church_count_5000` as train_church_count_5000_original_125,
    `church_synagogue_km` as train_church_synagogue_km_original_126,
    `culture_objects_top_25` as train_culture_objects_top_25_original_127,
    `culture_objects_top_25_raion` as train_culture_objects_top_25_raion_original_128,
    `detention_facility_km` as train_detention_facility_km_original_129,
    `detention_facility_raion` as train_detention_facility_raion_original_130,
    `ecology` as train_ecology_original_131,
    `exhibition_km` as train_exhibition_km_original_132,
    `fitness_km` as train_fitness_km_original_133,
    `floor` as train_floor_original_134,
    `full_sq` as train_full_sq_original_135,
    `green_part_1000` as train_green_part_1000_original_136,
    `green_part_1500` as train_green_part_1500_original_137,
    `green_part_2000` as train_green_part_2000_original_138,
    `green_part_3000` as train_green_part_3000_original_139,
    `green_part_500` as train_green_part_500_original_140,
    `green_part_5000` as train_green_part_5000_original_141,
    `green_zone_km` as train_green_zone_km_original_142,
    `green_zone_part` as train_green_zone_part_original_143,
    `healthcare_centers_raion` as train_healthcare_centers_raion_original_144,
    `hospice_morgue_km` as train_hospice_morgue_km_original_145,
    `hospital_beds_raion` as train_hospital_beds_raion_original_146,
    `ice_rink_km` as train_ice_rink_km_original_147,
    `incineration_km` as train_incineration_km_original_148,
    `incineration_raion` as train_incineration_raion_original_149,
    `indust_part` as train_indust_part_original_150,
    `industrial_km` as train_industrial_km_original_151,
    `kindergarten_km` as train_kindergarten_km_original_152,
    `kitch_sq` as train_kitch_sq_original_153,
    `kremlin_km` as train_kremlin_km_original_154,
    `leisure_count_1000` as train_leisure_count_1000_original_155,
    `leisure_count_1500` as train_leisure_count_1500_original_156,
    `leisure_count_2000` as train_leisure_count_2000_original_157,
    `leisure_count_3000` as train_leisure_count_3000_original_158,
    `leisure_count_500` as train_leisure_count_500_original_159,
    `leisure_count_5000` as train_leisure_count_5000_original_160,
    `life_sq` as train_life_sq_original_161,
    `market_count_1000` as train_market_count_1000_original_162,
    `market_count_1500` as train_market_count_1500_original_163,
    `market_count_2000` as train_market_count_2000_original_164,
    `market_count_3000` as train_market_count_3000_original_165,
    `market_count_500` as train_market_count_500_original_166,
    `market_count_5000` as train_market_count_5000_original_167,
    `market_shop_km` as train_market_shop_km_original_168,
    `material` as train_material_original_169,
    `max_floor` as train_max_floor_original_170,
    `metro_km_avto` as train_metro_km_avto_original_171,
    `metro_km_walk` as train_metro_km_walk_original_172,
    `metro_min_avto` as train_metro_min_avto_original_173,
    `mkad_km` as train_mkad_km_original_174,
    `mosque_count_1000` as train_mosque_count_1000_original_175,
    `mosque_count_1500` as train_mosque_count_1500_original_176,
    `mosque_count_2000` as train_mosque_count_2000_original_177,
    `mosque_count_3000` as train_mosque_count_3000_original_178,
    `mosque_count_500` as train_mosque_count_500_original_179,
    `mosque_count_5000` as train_mosque_count_5000_original_180,
    `mosque_km` as train_mosque_km_original_181,
    `museum_km` as train_museum_km_original_182,
    `nuclear_reactor_km` as train_nuclear_reactor_km_original_183,
    `nuclear_reactor_raion` as train_nuclear_reactor_raion_original_184,
    `num_room` as train_num_room_original_185,
    `office_count_1000` as train_office_count_1000_original_186,
    `office_count_1500` as train_office_count_1500_original_187,
    `office_count_2000` as train_office_count_2000_original_188,
    `office_count_3000` as train_office_count_3000_original_189,
    `office_count_500` as train_office_count_500_original_190,
    `office_count_5000` as train_office_count_5000_original_191,
    `office_km` as train_office_km_original_192,
    `office_raion` as train_office_raion_original_193,
    `office_sqm_1000` as train_office_sqm_1000_original_194,
    `office_sqm_1500` as train_office_sqm_1500_original_195,
    `office_sqm_2000` as train_office_sqm_2000_original_196,
    `office_sqm_3000` as train_office_sqm_3000_original_197,
    `office_sqm_500` as train_office_sqm_500_original_198,
    `office_sqm_5000` as train_office_sqm_5000_original_199,
    `oil_chemistry_km` as train_oil_chemistry_km_original_200,
    `oil_chemistry_raion` as train_oil_chemistry_raion_original_201,
    `park_km` as train_park_km_original_202,
    `power_transmission_line_km` as train_power_transmission_line_km_original_203,
    `preschool_education_centers_raion` as train_preschool_education_centers_raion_original_204,
    `preschool_km` as train_preschool_km_original_205,
    `preschool_quota` as train_preschool_quota_original_206,
    `product_type` as train_product_type_original_207,
    `prom_part_1000` as train_prom_part_1000_original_208,
    `prom_part_1500` as train_prom_part_1500_original_209,
    `prom_part_2000` as train_prom_part_2000_original_210,
    `prom_part_3000` as train_prom_part_3000_original_211,
    `prom_part_500` as train_prom_part_500_original_212,
    `prom_part_5000` as train_prom_part_5000_original_213,
    `public_healthcare_km` as train_public_healthcare_km_original_214,
    `public_transport_station_km` as train_public_transport_station_km_original_215,
    `radiation_km` as train_radiation_km_original_216,
    `radiation_raion` as train_radiation_raion_original_217,
    `railroad_1line` as train_railroad_1line_original_218,
    `railroad_km` as train_railroad_km_original_219,
    `railroad_station_avto_km` as train_railroad_station_avto_km_original_220,
    `railroad_station_avto_min` as train_railroad_station_avto_min_original_221,
    `railroad_terminal_raion` as train_railroad_terminal_raion_original_222,
    `raion_build_count_with_builddate_info` as train_raion_build_count_with_builddate_info_original_223,
    `raion_build_count_with_material_info` as train_raion_build_count_with_material_info_original_224,
    `sadovoe_km` as train_sadovoe_km_original_225,
    `school_education_centers_raion` as train_school_education_centers_raion_original_226,
    `school_education_centers_top_20_raion` as train_school_education_centers_top_20_raion_original_227,
    `school_km` as train_school_km_original_228,
    `school_quota` as train_school_quota_original_229,
    `shopping_centers_km` as train_shopping_centers_km_original_230,
    `shopping_centers_raion` as train_shopping_centers_raion_original_231,
    `sport_count_1000` as train_sport_count_1000_original_232,
    `sport_count_1500` as train_sport_count_1500_original_233,
    `sport_count_2000` as train_sport_count_2000_original_234,
    `sport_count_3000` as train_sport_count_3000_original_235,
    `sport_count_500` as train_sport_count_500_original_236,
    `sport_count_5000` as train_sport_count_5000_original_237,
    `sport_objects_raion` as train_sport_objects_raion_original_238,
    `stadium_km` as train_stadium_km_original_239,
    `state` as train_state_original_240,
    `swim_pool_km` as train_swim_pool_km_original_241,
    `theater_km` as train_theater_km_original_242,
    `thermal_power_plant_km` as train_thermal_power_plant_km_original_243,
    `thermal_power_plant_raion` as train_thermal_power_plant_raion_original_244,
    `trc_count_1000` as train_trc_count_1000_original_245,
    `trc_count_1500` as train_trc_count_1500_original_246,
    `trc_count_2000` as train_trc_count_2000_original_247,
    `trc_count_3000` as train_trc_count_3000_original_248,
    `trc_count_500` as train_trc_count_500_original_249,
    `trc_count_5000` as train_trc_count_5000_original_250,
    `trc_sqm_1000` as train_trc_sqm_1000_original_251,
    `trc_sqm_1500` as train_trc_sqm_1500_original_252,
    `trc_sqm_2000` as train_trc_sqm_2000_original_253,
    `trc_sqm_3000` as train_trc_sqm_3000_original_254,
    `trc_sqm_500` as train_trc_sqm_500_original_255,
    `trc_sqm_5000` as train_trc_sqm_5000_original_256,
    `ts_km` as train_ts_km_original_257,
    `ttk_km` as train_ttk_km_original_258,
    `university_km` as train_university_km_original_259,
    `university_top_20_raion` as train_university_top_20_raion_original_260,
    `water_1line` as train_water_1line_original_261,
    `water_km` as train_water_km_original_262,
    `water_treatment_km` as train_water_treatment_km_original_263,
    `work_all` as train_work_all_original_264,
    `work_male` as train_work_male_original_265,
    `workplaces_km` as train_workplaces_km_original_266,
    `young_female` as train_young_female_original_267,
    `young_male` as train_young_male_original_268,
    `zd_vokzaly_avto_km` as train_zd_vokzaly_avto_km_original_269,
    `num_room` as train_num_room_combine_270,
    `state` as train_state_combine_270,
    `num_room` as train_num_room_combine_271,
    `ecology` as train_ecology_combine_271,
    `num_room` as train_num_room_combine_272,
    `material` as train_material_combine_272,
    `num_room` as train_num_room_combine_273,
    `university_top_20_raion` as train_university_top_20_raion_combine_273,
    case when !isnull(at(`num_room`, 0)) over train_sport_objects_raion_timestamp_0s_64d_100 then count_where(`num_room`, `num_room` = at(`num_room`, 0)) over train_sport_objects_raion_timestamp_0s_64d_100 else null end as train_num_room_window_count_274,
    distinct_count(`full_sq`) over train_num_room_timestamp_0s_64d_100 as train_full_sq_window_unique_count_275,
    case when !isnull(at(`num_room`, 0)) over train_sport_count_3000_timestamp_0s_5d_200 then count_where(`num_room`, `num_room` = at(`num_room`, 0)) over train_sport_count_3000_timestamp_0s_5d_200 else null end as train_num_room_window_count_276,
    case when !isnull(at(`num_room`, 0)) over train_sport_count_3000_timestamp_0s_7d_200 then count_where(`num_room`, `num_room` = at(`num_room`, 0)) over train_sport_count_3000_timestamp_0s_7d_200 else null end as train_num_room_window_count_277,
    max(`indust_part`) over train_num_room_timestamp_0s_64d_200 as train_indust_part_window_max_278,
    min(`indust_part`) over train_cafe_count_1500_na_price_timestamp_0s_64d_100 as train_indust_part_window_min_279,
    max(`green_zone_part`) over train_num_room_timestamp_0s_7d_100 as train_green_zone_part_window_max_280,
    max(`green_zone_part`) over train_num_room_timestamp_0s_5d_200 as train_green_zone_part_window_max_281,
    fz_top1_ratio(`0_13_all`) over train_7_14_female_timestamp_0s_64d_200 as train_0_13_all_window_top1_ratio_282,
    fz_top1_ratio(`0_13_all`) over train_7_14_female_timestamp_0s_14d_100 as train_0_13_all_window_top1_ratio_283,
    case when !isnull(at(`school_quota`, 0)) over train_num_room_timestamp_0s_64d_100 then count_where(`school_quota`, `school_quota` = at(`school_quota`, 0)) over train_num_room_timestamp_0s_64d_100 else null end as train_school_quota_window_count_284,
    case when !isnull(at(`preschool_quota`, 0)) over train_num_room_timestamp_0s_64d_100 then count_where(`preschool_quota`, `preschool_quota` = at(`preschool_quota`, 0)) over train_num_room_timestamp_0s_64d_100 else null end as train_preschool_quota_window_count_285,
    fz_top1_ratio(`num_room`) over train_sport_count_3000_timestamp_0s_2d_100 as train_num_room_window_top1_ratio_286,
    distinct_count(`school_education_centers_raion`) over train_num_room_timestamp_0s_64d_200 as train_school_education_centers_raion_window_unique_count_287
from
    `train`
    window train_sport_objects_raion_timestamp_0s_64d_100 as (partition by `sport_objects_raion` order by `timestamp` rows_range between 64d open preceding and 0s preceding MAXSIZE 100),
    train_num_room_timestamp_0s_64d_100 as (partition by `num_room` order by `timestamp` rows_range between 64d open preceding and 0s preceding MAXSIZE 100),
    train_sport_count_3000_timestamp_0s_5d_200 as (partition by `sport_count_3000` order by `timestamp` rows_range between 5d open preceding and 0s preceding MAXSIZE 200),
    train_sport_count_3000_timestamp_0s_7d_200 as (partition by `sport_count_3000` order by `timestamp` rows_range between 7d open preceding and 0s preceding MAXSIZE 200),
    train_num_room_timestamp_0s_64d_200 as (partition by `num_room` order by `timestamp` rows_range between 64d open preceding and 0s preceding MAXSIZE 200),
    train_cafe_count_1500_na_price_timestamp_0s_64d_100 as (partition by `cafe_count_1500_na_price` order by `timestamp` rows_range between 64d open preceding and 0s preceding MAXSIZE 100),
    train_num_room_timestamp_0s_7d_100 as (partition by `num_room` order by `timestamp` rows_range between 7d open preceding and 0s preceding MAXSIZE 100),
    train_num_room_timestamp_0s_5d_200 as (partition by `num_room` order by `timestamp` rows_range between 5d open preceding and 0s preceding MAXSIZE 200),
    train_7_14_female_timestamp_0s_64d_200 as (partition by `7_14_female` order by `timestamp` rows_range between 64d open preceding and 0s preceding MAXSIZE 200),
    train_7_14_female_timestamp_0s_14d_100 as (partition by `7_14_female` order by `timestamp` rows_range between 14d open preceding and 0s preceding MAXSIZE 100),
    train_sport_count_3000_timestamp_0s_2d_100 as (partition by `sport_count_3000` order by `timestamp` rows_range between 2d open preceding and 0s preceding MAXSIZE 100);