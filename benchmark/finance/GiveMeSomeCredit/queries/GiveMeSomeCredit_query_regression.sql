# start sql code
# output table name: sql_table

select
    `id` as id_1,
    `timestamp` as cs-training_timestamp_original_0,
    `id` as cs-training_id_original_1,
    `SeriousDlqin2yrs` as cs-training_SeriousDlqin2yrs_original_2,
    `DebtRatio` as cs-training_DebtRatio_original_3,
    `MonthlyIncome` as cs-training_MonthlyIncome_original_4,
    `NumberOfDependents` as cs-training_NumberOfDependents_original_5,
    `NumberOfOpenCreditLinesAndLoans` as cs-training_NumberOfOpenCreditLinesAndLoans_original_6,
    `NumberOfTime30-59DaysPastDueNotWorse` as cs-training_NumberOfTime30-59DaysPastDueNotWorse_original_7,
    `NumberOfTime60-89DaysPastDueNotWorse` as cs-training_NumberOfTime60-89DaysPastDueNotWorse_original_8,
    `NumberOfTimes90DaysLate` as cs-training_NumberOfTimes90DaysLate_original_9,
    `NumberRealEstateLoansOrLines` as cs-training_NumberRealEstateLoansOrLines_original_10,
    `RevolvingUtilizationOfUnsecuredLines` as cs-training_RevolvingUtilizationOfUnsecuredLines_original_11,
    `age` as cs-training_age_original_12,
    min(`DebtRatio`) over cs-training_NumberOfTime60-89DaysPastDueNotWorse_timestamp_0s_1h_100 as cs-training_DebtRatio_window_min_13,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_100 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_14,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_100 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_15,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_NumberOfTime60-89DaysPastDueNotWorse_timestamp_0s_1h_100 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_16,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_NumberOfTime30-59DaysPastDueNotWorse_timestamp_0s_1h_100 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_17,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_NumberRealEstateLoansOrLines_timestamp_0s_1h_200 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_18,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_NumberOfDependents_timestamp_0s_1h_200 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_19,
    min(`RevolvingUtilizationOfUnsecuredLines`) over cs-training_age_timestamp_0s_1h_200 as cs-training_RevolvingUtilizationOfUnsecuredLines_window_min_20,
    distinct_count(`NumberOfTime60-89DaysPastDueNotWorse`) over cs-training_NumberOfDependents_timestamp_0s_1h_100 as cs-training_NumberOfTime60-89DaysPastDueNotWorse_window_unique_count_21,
    distinct_count(`NumberOfTimes90DaysLate`) over cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_200 as cs-training_NumberOfTimes90DaysLate_window_unique_count_22,
    fz_top1_ratio(`NumberOfTime60-89DaysPastDueNotWorse`) over cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0_10_ as cs-training_NumberOfTime60-89DaysPastDueNotWorse_window_top1_ratio_23,
    distinct_count(`NumberOfDependents`) over cs-training_age_timestamp_0s_1h_100 as cs-training_NumberOfDependents_window_unique_count_24,
    fz_top1_ratio(`age`) over cs-training_NumberOfDependents_timestamp_0s_1h_100 as cs-training_age_window_top1_ratio_25,
    fz_top1_ratio(`age`) over cs-training_NumberOfDependents_timestamp_0_10_ as cs-training_age_window_top1_ratio_26,
    distinct_count(`NumberOfTimes90DaysLate`) over cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0_10_ as cs-training_NumberOfTimes90DaysLate_window_unique_count_27,
    distinct_count(`NumberOfDependents`) over cs-training_age_timestamp_0_10_ as cs-training_NumberOfDependents_window_unique_count_28,
    case when !isnull(at(`age`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0_10_ then count_where(`age`, `age` = at(`age`, 0)) over cs-training_NumberOfTimes90DaysLate_timestamp_0_10_ else null end as cs-training_age_window_count_29,
    distinct_count(`NumberOfTime30-59DaysPastDueNotWorse`) over cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_100 as cs-training_NumberOfTime30-59DaysPastDueNotWorse_window_unique_count_30
from
    `cs-training`
    window cs-training_NumberOfTime60-89DaysPastDueNotWorse_timestamp_0s_1h_100 as (partition by `NumberOfTime60-89DaysPastDueNotWorse` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_100 as (partition by `NumberOfOpenCreditLinesAndLoans` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfTimes90DaysLate_timestamp_0s_1h_100 as (partition by `NumberOfTimes90DaysLate` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfTime30-59DaysPastDueNotWorse_timestamp_0s_1h_100 as (partition by `NumberOfTime30-59DaysPastDueNotWorse` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberRealEstateLoansOrLines_timestamp_0s_1h_200 as (partition by `NumberRealEstateLoansOrLines` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    cs-training_NumberOfDependents_timestamp_0s_1h_200 as (partition by `NumberOfDependents` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    cs-training_age_timestamp_0s_1h_200 as (partition by `age` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    cs-training_NumberOfDependents_timestamp_0s_1h_100 as (partition by `NumberOfDependents` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0s_1h_200 as (partition by `NumberOfOpenCreditLinesAndLoans` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 200),
    cs-training_NumberOfOpenCreditLinesAndLoans_timestamp_0_10_ as (partition by `NumberOfOpenCreditLinesAndLoans` order by `timestamp` rows between 10 open preceding and 0 preceding),
    cs-training_age_timestamp_0s_1h_100 as (partition by `age` order by `timestamp` rows_range between 1h open preceding and 0s preceding MAXSIZE 100),
    cs-training_NumberOfDependents_timestamp_0_10_ as (partition by `NumberOfDependents` order by `timestamp` rows between 10 open preceding and 0 preceding),
    cs-training_age_timestamp_0_10_ as (partition by `age` order by `timestamp` rows between 10 open preceding and 0 preceding),
    cs-training_NumberOfTimes90DaysLate_timestamp_0_10_ as (partition by `NumberOfTimes90DaysLate` order by `timestamp` rows between 10 open preceding and 0 preceding);