# start sql code
# output table name: sql_table

select
    `Id` as Id_1,
    `Open_Date` as train_Open_Date_original_0,
    `Id` as train_Id_original_1,
    `revenue` as train_revenue_original_2,
    `City` as train_City_original_3,
    `City_Group` as train_City_Group_original_4,
    `P1` as train_P1_original_5,
    `P10` as train_P10_original_6,
    `P11` as train_P11_original_7,
    `P12` as train_P12_original_8,
    `P13` as train_P13_original_9,
    `P14` as train_P14_original_10,
    `P15` as train_P15_original_11,
    `P16` as train_P16_original_12,
    `P17` as train_P17_original_13,
    `P18` as train_P18_original_14,
    `P19` as train_P19_original_15,
    `P2` as train_P2_original_16,
    `P20` as train_P20_original_17,
    `P21` as train_P21_original_18,
    `P22` as train_P22_original_19,
    `P23` as train_P23_original_20,
    `P24` as train_P24_original_21,
    `P25` as train_P25_original_22,
    `P26` as train_P26_original_23,
    `P27` as train_P27_original_24,
    `P28` as train_P28_original_25,
    `P29` as train_P29_original_26,
    `P3` as train_P3_original_27,
    `P30` as train_P30_original_28,
    `P31` as train_P31_original_29,
    `P32` as train_P32_original_30,
    `P33` as train_P33_original_31,
    `P34` as train_P34_original_32,
    `P35` as train_P35_original_33,
    `P36` as train_P36_original_34,
    `P37` as train_P37_original_35,
    `P4` as train_P4_original_36,
    `P5` as train_P5_original_37,
    `P6` as train_P6_original_38,
    `P7` as train_P7_original_39,
    `P8` as train_P8_original_40,
    `P9` as train_P9_original_41,
    `Type` as train_Type_original_42,
    `P4` as train_P4_multiply_43,
    `P28` as train_P28_multiply_43,
    `P2` as train_P2_multiply_43,
    avg(`P13`) over train_City_Open_Date_0s_64d_100 as train_P13_window_avg_44,
    `P6` as train_P6_combine_45,
    `City` as train_City_combine_45,
    `P31` as train_P31_combine_46,
    `City` as train_City_combine_46,
    `P20` as train_P20_combine_47,
    `City` as train_City_combine_47,
    `P8` as train_P8_combine_48,
    `City` as train_City_combine_48,
    `P29` as train_P29_divide_49,
    `P26` as train_P26_divide_49,
    avg(`P13`) over train_City_Open_Date_0s_32d_100 as train_P13_window_avg_50,
    `P29` as train_P29_multiply_51,
    `P28` as train_P28_multiply_51,
    min(`P4`) over train_City_Open_Date_0s_64d_100 as train_P4_window_min_52,
    min(`P4`) over train_City_Open_Date_0s_32d_100 as train_P4_window_min_53
from
    `train`
    window train_City_Open_Date_0s_64d_100 as (partition by `City` order by `Open_Date` rows_range between 64d open preceding and 0s preceding MAXSIZE 100),
    train_City_Open_Date_0s_32d_100 as (partition by `City` order by `Open_Date` rows_range between 32d open preceding and 0s preceding MAXSIZE 100);